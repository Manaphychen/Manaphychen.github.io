import{_ as s,c as i,o as a,aj as n}from"./chunks/framework._AF764y6.js";const l="/assets/rUnZj0.CmhDSOZh.png",h="/assets/9vW5vS.BaHYHdFk.png",p="/assets/QDDGiP.Be-OwbwP.png",D=JSON.parse('{"title":"MySQL 笔记","description":"","frontmatter":{"title":"MySQL 笔记","date":"2023-10-25T15:32:32.000Z","permalink":"/mysql/notes/","categories":["数据库","MySQL"],"tags":["MySQL"],"author":"Manaphy"},"headers":[],"relativePath":"database/MySQL/01.MySQL 笔记.md","filePath":"database/MySQL/01.MySQL 笔记.md","lastUpdated":1743620201000}'),k={name:"database/MySQL/01.MySQL 笔记.md"},t=n(`<h2 id="windows-mysql-8-0安装教程" tabindex="-1">Windows MySQL 8.0安装教程 <a class="header-anchor" href="#windows-mysql-8-0安装教程" aria-label="Permalink to “Windows MySQL 8.0安装教程”">​</a></h2><ol><li>从<a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noreferrer">https://downloads.mysql.com/archives/community/</a> 下载zip包</li><li>解压到指定目录，如 <code>D:\\env\\mysql-8.0.26</code></li><li>配置环境变量: 在path中配置<code>D:\\env\\mysql-8.0.26\\bin</code></li><li>在mysql目录下创建<code>my.ini</code>文件</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[mysql]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置mysql客户端默认字符集</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">default-character-set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [client]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置mysql客户端连接服务端时默认使用的端口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">port</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">3306</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">default-character-set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置3306端口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">port</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 3306</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置mysql的安装目录</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">basedir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;">\\e</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">nv</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;">\\m</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ysql-8.0.26</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置 mysql数据库的数据的存放目录，MySQL 8+ 不需要以下配置，系统自己生成即可，否则有可能报错</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">datadir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">D:</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;">\\e</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">nv</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;">\\m</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ysql-8.0.26</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;">\\d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ata</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 允许最大连接数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">max_connections</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">200</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 允许连接失败的次数。这是为了防止有人从该主机试图攻击数据库系统</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">max_connect_errors</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">10</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 服务端使用的字符集默认为UTF8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">character-set-server</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 创建新表时将使用的默认存储引擎</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">default-storage-engine</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">INNODB</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 默认使用 caching_sha2_password 插件认证</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">authentication_policy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">caching_sha2_password</span></span></code></pre></div><ol start="5"><li>以管理员身份运行cmd</li><li>在MySQL安装目录的 bin 目录下执行命令：</li></ol><p>注：重装时要清空data目录 <code>mysqld --initialize --console</code></p><ol start="7"><li>执行完成后，会打印 root 用户的初始默认密码,复制密码</li></ol><p><code>A temporary password is generated for root@localhost: b(f:37xt6awA</code></p><ol start="8"><li>在bin目录下输入</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mysqld.exe</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> install</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 启动mysql服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">net</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql</span></span></code></pre></div><ol start="9"><li>服务启动后,执行 <code>mysql -uroot -p</code> 回车后输入默认密码<code>b(f:37xt6awA</code></li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 修改密码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;localhost&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;yourpassword&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 设置允许别人远程链接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> mysql;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> host </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;%&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 刷新权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">flush privileges;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 把所有权限给了root用户,ip不限,只要是root用户登录就能进来</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> all privileges  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> root</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 再次刷新权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">flush privileges;</span></span></code></pre></div><h2 id="mac-安装mysql压缩版" tabindex="-1">Mac 安装MySQL压缩版 <a class="header-anchor" href="#mac-安装mysql压缩版" aria-label="Permalink to “Mac 安装MySQL压缩版”">​</a></h2><ol><li>从官网下载对应的版本，如 <code>mysql-8.0.34-macos13-arm64.tar.gz</code> 。过程略...</li><li>解压到想要安装的目录并重命名，如 <code>/Users/manaphy/opt/mysql</code></li><li>配置环境变量(这里的MYSQL_HOME要跟你安装的目录相同)</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> MYSQL_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">/Users/manaphy/opt/mysql</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$MYSQL_HOME/bin:$MYSQL_HOME/support-files:$PATH</span></span></code></pre></div><ol start="4"><li>打开修改 <code>/Users/manaphy/opt/mysql/support-files/mysql.server</code> 文件，找到并添加以下内容</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">basedir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/Users/manaphy/opt/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">datadir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$basedir</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/data</span></span></code></pre></div><ol start="5"><li>初始化配置文件，在mysql目录创建 <code>my.cnf</code> 文件并填写以下内容</li></ol><div class="language-properties vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">[mysql]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置mysql客户端默认字符集</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">default-character-set</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [client]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置mysql客户端连接服务端时默认使用的端口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=3306</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">default-character-set</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置3306端口</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">port</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> = 3306</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 允许最大连接数</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">max_connections</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=200</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 允许连接失败的次数。这是为了防止有人从该主机试图攻击数据库系统</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">max_connect_errors</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=10</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 服务端使用的字符集默认为UTF8</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">character-set-server</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=utf8mb4</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 创建新表时将使用的默认存储引擎</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">default-storage-engine</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=INNODB</span></span></code></pre></div><ol start="6"><li>初始化mysql，执行以下命令(这里的<strong>manaphy</strong>是你自己的用户名)</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysqld</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --initialize</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --user=manaphy</span></span></code></pre></div><p>执行后从<code>[Server] A temporary password is generated for root@localhost: &gt;FqX!.R&lt;)1aT</code>获取root账号的初始密码<code>&gt;FqX!.R&lt;)1aT</code></p><ol start="7"><li>启动mysql</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mysql.server</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> start</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> # 启动</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mysql.server</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> stop</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> # 停止</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mysql.server</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> status</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #查看状态</span></span></code></pre></div><ol start="8"><li>登录并重置密码</li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">mysql </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">uroot </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">p </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 回车后输入刚刚的默认密码</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 修改密码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;localhost&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> IDENTIFIED </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">BY</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;yourpassword&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 设置允许别人远程链接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> mysql;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> host </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;%&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> user </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 刷新权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">flush privileges;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 把所有权限给了root用户,ip不限,只要是root用户登录就能进来</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">grant</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> all privileges  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">on</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> to</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> root</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">@</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;%&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 再次刷新权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">flush privileges;</span></span></code></pre></div><h2 id="清理-mysql-的-binlog" tabindex="-1">清理 MySQL 的 binlog <a class="header-anchor" href="#清理-mysql-的-binlog" aria-label="Permalink to “清理 MySQL 的 binlog”">​</a></h2><p><strong>手动删除</strong></p><p>直接在 <code>/var/lib/mysql</code> 路径下，将 <code>binlog.0*</code> 删除掉（注意不要删除 <code>binlog.index</code>）</p><p>该方法不推荐，因为手动删除并不会更新 <code>binlog.index</code>，而 <code>binlog.index</code> 的作用是加快查找 <code>binlog</code> 文件的速度。</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 删除指定编号之前的 binlog</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">PURGE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">MASTER</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> LOGS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">TO</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;binlog.000002&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 删除指定日期之前的 binlog</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">PURGE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">MASTER</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> LOGS </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">BEFORE</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;2020-11-11 11:11:11&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 清空所有 binlog</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">RESET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> MASTER</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">-- 配置自动清理</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">set</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> global</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> binlog_expire_logs_seconds</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h2 id="导出mysql在特定时间的增删改记录" tabindex="-1">导出MySQL在特定时间的增删改记录 <a class="header-anchor" href="#导出mysql在特定时间的增删改记录" aria-label="Permalink to “导出MySQL在特定时间的增删改记录”">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">/usr/bin/mysqlbinlog</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --start-datetime=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;2021-01-20 14:00:00&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	--stop-datetime=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;2021-01-20 16:00:00&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/lib/mysql/binlog.000009</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">  --base64-output=DECODE-ROWS</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -v</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/var/lib/mysql/mysqlbak.log</span></span></code></pre></div><h2 id="mysql中的any-value-函数" tabindex="-1">MySQL中的any_value()函数 <a class="header-anchor" href="#mysql中的any-value-函数" aria-label="Permalink to “MySQL中的any_value()函数”">​</a></h2><ol><li>MySQL5.7之后，sql_mode中ONLY_FULL_GROUP_BY模式默认设置为打开状态。</li><li>ONLY_FULL_GROUP_BY的语义就是确定select target list中的所有列的值都是明确语义，简单的说来，在此模式下，target list中的值要么是来自于聚合函数（sum、avg、max等）的结果，要么是来自于group by list中的表达式的值</li><li>MySQL提供了any_value()函数来抑制ONLY_FULL_GROUP_BY值被拒绝</li><li>any_value()会选择被分到同一组的数据里第一条数据的指定列值作为返回数据</li></ol><h2 id="修改docker的mysql时区" tabindex="-1">修改docker的mysql时区 <a class="header-anchor" href="#修改docker的mysql时区" aria-label="Permalink to “修改docker的mysql时区”">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> cp</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /usr/share/zoneinfo/Asia/Shanghai</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql:/etc/localtime</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql</span></span></code></pre></div><h2 id="mysql查询重复数据" tabindex="-1">MySQL查询重复数据 <a class="header-anchor" href="#mysql查询重复数据" aria-label="Permalink to “MySQL查询重复数据”">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> \`emp\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> WHERE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> \`emp\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> )</span></span></code></pre></div><h2 id="docker中mysql8-0修改密码" tabindex="-1">Docker中MySQL8.0修改密码 <a class="header-anchor" href="#docker中mysql8-0修改密码" aria-label="Permalink to “Docker中MySQL8.0修改密码”">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 进入docker中的mysql</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> exec</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -it</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -p</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 进入 mysql 数据库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">use</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 使用以下两条命令修改密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ALTER</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;@&#39;%&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> IDENTIFIED</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;chen111&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> PASSWORD</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> EXPIRE</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> NEVER</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ALTER</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> USER</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;@&#39;%&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> IDENTIFIED</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> BY</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;chen111&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 退出并重启容器</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">exit</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql</span></span></code></pre></div><h2 id="mysql实现rownum方式" tabindex="-1">MySQL实现rownum方式 <a class="header-anchor" href="#mysql实现rownum方式" aria-label="Permalink to “MySQL实现rownum方式”">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> @rownum:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">@rownum</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> rownum, employee.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">*</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> @rownum:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) r, employee;</span></span></code></pre></div><h2 id="mysql在不清除数据的情况下重置id自增长" tabindex="-1">MySQL在不清除数据的情况下重置id自增长 <a class="header-anchor" href="#mysql在不清除数据的情况下重置id自增长" aria-label="Permalink to “MySQL在不清除数据的情况下重置id自增长”">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">alter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> \`example\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> drop</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> id;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">alter</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> table</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> \`example\`</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> add</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">bigint</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> primary key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> not null</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> auto_increment </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">first</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h2 id="mysql让自增id加1" tabindex="-1">MySQL让自增id加1 <a class="header-anchor" href="#mysql让自增id加1" aria-label="Permalink to “MySQL让自增id加1”">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> sometable </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> where</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 10</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> order by</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">desc</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h2 id="mysql修改表的排序规则" tabindex="-1">MySQL修改表的排序规则 <a class="header-anchor" href="#mysql修改表的排序规则" aria-label="Permalink to “MySQL修改表的排序规则”">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> TABLE</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> \`example\`</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> CONVERT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">TO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> CHARACTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> SET</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> utf8mb4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">COLLATE</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> utf8mb4_general_ci;</span></span></code></pre></div><h2 id="mysql统计每天-每周-每年订单量" tabindex="-1">Mysql统计每天 每周 每年订单量 <a class="header-anchor" href="#mysql统计每天-每周-每年订单量" aria-label="Permalink to “Mysql统计每天 每周 每年订单量”">​</a></h2><h3 id="统计一周订单量" tabindex="-1">统计一周订单量 <a class="header-anchor" href="#统计一周订单量" aria-label="Permalink to “统计一周订单量”">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">	DATE</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">AS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> count </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FROM</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	orders </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	DATE_SUB( CURDATE(), INTERVAL </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">7</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> DAY</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> DATE</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">( create_date ) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">GROUP BY</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">	date</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><p>sql 语句解析</p><ul><li>date(create_date): 将日期格式化为 <code>2000-01-01</code>这种格式</li><li>curdate() :获取当前日期 <code>2020-06-30</code> 等同于 <code>date(now())</code></li><li>date_sub(curdate(), interval 7 day): 获取7天前的日期</li></ul><p>但该语句不会显示没有订单的日期,参考其他博客将sql优化为如下</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">select</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">date</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ifnull</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">b</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> count</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> curdate() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    union all</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> date_sub(curdate(), interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> click_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    union all</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> date_sub(curdate(), interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> click_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    union all</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> date_sub(curdate(), interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> click_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    union all</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> date_sub(curdate(), interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> click_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    union all</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> date_sub(curdate(), interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> click_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    union all</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> date_sub(curdate(), interval </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">6</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> day</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> click_date</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">left join</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">  select</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> createdate, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> count</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">  from</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> orders</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">  group by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">on</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> b</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">createdate</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h3 id="统计每年的订单量" tabindex="-1">统计每年的订单量 <a class="header-anchor" href="#统计每年的订单量" aria-label="Permalink to “统计每年的订单量”">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> year</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> count </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> orders  </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> year</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h3 id="统计今年每个月的订单量" tabindex="-1">统计今年每个月的订单量 <a class="header-anchor" href="#统计今年每个月的订单量" aria-label="Permalink to “统计今年每个月的订单量”">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> MONTH</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> month</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> count </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> orders </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> month</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> month</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h3 id="统计今年每周的订单量" tabindex="-1">统计今年每周的订单量 <a class="header-anchor" href="#统计今年每周的订单量" aria-label="Permalink to “统计今年每周的订单量”">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">SELECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> WEEK</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> week</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> count </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> orders </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(create_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> YEAR</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">NOW</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()) </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">GROUP BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> week</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ORDER BY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> week</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span></code></pre></div><h3 id="查询mysql执行情况" tabindex="-1">查询MySQL执行情况 <a class="header-anchor" href="#查询mysql执行情况" aria-label="Permalink to “查询MySQL执行情况”">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">SHOW FULL PROCESSLIST;</span></span></code></pre></div><h2 id="基于docker容器搭建mysql主从服务器" tabindex="-1">基于docker容器搭建mysql主从服务器 <a class="header-anchor" href="#基于docker容器搭建mysql主从服务器" aria-label="Permalink to “基于docker容器搭建mysql主从服务器”">​</a></h2><h3 id="mysql-主从复制原理" tabindex="-1">MySQL 主从复制原理 <a class="header-anchor" href="#mysql-主从复制原理" aria-label="Permalink to “MySQL 主从复制原理”">​</a></h3><p><img src="`+l+`" alt=""></p><h4 id="_1-在服务器上建立以下目录" tabindex="-1">1.在服务器上建立以下目录 <a class="header-anchor" href="#_1-在服务器上建立以下目录" aria-label="Permalink to “1.在服务器上建立以下目录”">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mysql/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">├──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> master</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   │</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> data</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">└──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> slave</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">    │</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> my.cnf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> data</span></span></code></pre></div><h4 id="_2-编辑主从数据库配置my-cnf" tabindex="-1">2.编辑主从数据库配置my.cnf <a class="header-anchor" href="#_2-编辑主从数据库配置my-cnf" aria-label="Permalink to “2.编辑主从数据库配置my.cnf”">​</a></h4><h5 id="_2-1-主数据库" tabindex="-1">2.1 主数据库 <a class="header-anchor" href="#_2-1-主数据库" aria-label="Permalink to “2.1 主数据库”">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">pid-file</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">        =</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/run/mysqld/mysqld.pid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">socket</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">          =</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/run/mysqld/mysqld.sock</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">datadir</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">         =</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">secure-file-priv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">lower_case_table_names</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">symbolic-links</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#主服务器唯一ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">100</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#启用二进制日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">mysql-bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置不要复制的数据库(可设置多个)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-ignore-db=mysql</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-ignore-db=information_schema</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#设置需要复制的数据库</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-do-db=spring_boot</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#设置logbin格式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog_format=STATEMENT</span></span></code></pre></div><h5 id="_2-2-从数据库" tabindex="-1">2.2 从数据库 <a class="header-anchor" href="#_2-2-从数据库" aria-label="Permalink to “2.2 从数据库”">​</a></h5><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">pid-file</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">        =</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/run/mysqld/mysqld.pid</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">socket</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">          =</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/run/mysqld/mysqld.sock</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">datadir</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">         =</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">secure-file-priv</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> /var/lib/mysql</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">lower_case_table_names</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">symbolic-links</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#从服务器唯一ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">101</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">mysql-bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#启用中继日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">relay_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">edu-mysql-relay-bin</span></span></code></pre></div><h4 id="_3-使用-docker-搭建-mysql" tabindex="-1">3. 使用 docker 搭建 mysql <a class="header-anchor" href="#_3-使用-docker-搭建-mysql" aria-label="Permalink to “3. 使用 docker 搭建 mysql”">​</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#拉取镜像</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> pull</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql:5.7.29</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#搭建主服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql_master</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 23306:3306</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --privileged=true</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">-v </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/root/docker/mysql/master/config/my.cnf:/etc/mysql/my.cnf</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">-v </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/root/docker/mysql/master/data:/var/lib/mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">MYSQL_ROOT_PASSWORD=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">123456</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql:5.7.29</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#搭建从服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> run</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql_slave</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">  -p</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 23307:3306</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --privileged=true</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">-v </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/root/docker/mysql/slave/config/my.cnf:/etc/mysql/my.cnf</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">-v </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/root/docker/mysql/slave/data:/var/lib/mysql</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;"> \\</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">-e </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">MYSQL_ROOT_PASSWORD=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">123456</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> mysql:5.7.29</span></span></code></pre></div><p>通过Navicat等连接工具连接数据库连接主服务器, 执行创建用户及授权命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>create user &#39;slave&#39;@&#39;%&#39; identified with mysql_native_password by &#39;123456&#39;;</span></span>
<span class="line"><span>GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO &#39;slave&#39;@&#39;%&#39;;</span></span></code></pre></div><p>执行<code>show master status;</code>获取以下结果</p><p><img src="https://www.pnglog.com/00SPXe.png" alt=""></p><p>在服务器执行<code>docker inspect --format=&#39;{ {.NetworkSettings.IPAddress} }&#39; 容器名称|容器id</code>获取主服务器容器的独立ip</p><p><img src="`+h+`" alt=""></p><p>连接从服务器,执行以下命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>change master to master_host=&#39;172.17.0.4&#39;,  # Master 的地址，指的是容器的独立 ip</span></span>
<span class="line"><span>master_user=&#39;slave&#39;, #用于数据同步的用户</span></span>
<span class="line"><span>master_password=&#39;123456&#39;, #用于同步的用户的密码</span></span>
<span class="line"><span>master_port=3306, # Master 的端口号，指的是容器的端口号</span></span>
<span class="line"><span>master_log_file=&#39;mysql-bin.000003&#39;, #指定 Slave 从哪个日志文件开始复制数据，即上图中的 File 字段的值</span></span>
<span class="line"><span>master_log_pos= 935, #从哪个 Position 开始读，即上图中的 Position 字段的值</span></span>
<span class="line"><span>master_connect_retry=30; #如果连接失败，重试的时间间隔，单位是秒，默认是60秒</span></span></code></pre></div><p>执行<code>start slave</code>通过<code>show slave status</code>查看状态</p><p><img src="`+p+`" alt=""></p><p>红框里两个Yes代表搭建成功</p><h3 id="搭建-mysql-数据库主从复制-双主双从" tabindex="-1">搭建 MySQL 数据库主从复制（双主双从） <a class="header-anchor" href="#搭建-mysql-数据库主从复制-双主双从" aria-label="Permalink to “搭建 MySQL 数据库主从复制（双主双从）”">​</a></h3><h4 id="_1-双主机配置" tabindex="-1">1. 双主机配置 <a class="header-anchor" href="#_1-双主机配置" aria-label="Permalink to “1. 双主机配置”">​</a></h4><p>Master1配置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#主服务器唯一ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">100</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#启用二进制日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">mysql-bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置不要复制的数据库(可设置多个)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-ignore-db=mysql</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-ignore-db=information_schema</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#设置需要复制的数据库</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-do-db=需要复制的主数据库名字</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#设置logbin格式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog_format=STATEMENT</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 在作为从数据库的时候，有写入操作也要更新二进制日志文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">log-slave-updates</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#表示自增长字段每次递增的量，指自增字段的起始值，其默认值是1，取值范围是1 .. 65535</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">auto-increment-increment</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 表示自增长字段从哪个数开始，指字段一次递增多少，他的取值范围是1 .. 65535</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">auto-increment-offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">1</span></span></code></pre></div><p>Master2配置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#主服务器唯一ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">102</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #启用二进制日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">mysql-bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置不要复制的数据库(可设置多个)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-ignore-db=mysql</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-ignore-db=information_schema</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#设置需要复制的数据库</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog-do-db=需要复制的主数据库名字</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#设置logbin格式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#binlog_format=STATEMENT</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 在作为从数据库的时候，有写入操作也要更新二进制日志文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">log-slave-updates</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#表示自增长字段每次递增的量，指自增字段的起始值，其默认值是1，取值范围是1 .. 65535</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">auto-increment-increment</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 表示自增长字段从哪个数开始，指字段一次递增多少，他的取值范围是1 .. 65535</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">auto-increment-offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">2</span></span></code></pre></div><h4 id="_2-双从机配置" tabindex="-1">2. 双从机配置 <a class="header-anchor" href="#_2-双从机配置" aria-label="Permalink to “2. 双从机配置”">​</a></h4><p>Slave1配置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#从服务器唯一ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">101</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">mysql-bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#启用中继日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">relay_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">edu-mysql-relay-bin</span></span></code></pre></div><p>Slave2配置</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#从服务器唯一ID</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">server-id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">103</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">log-bin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">mysql-bin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#启用中继日志</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">relay_log</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">edu-mysql-relay-bin</span></span></code></pre></div><h4 id="_3-双主机、双从机重启-mysql-服务" tabindex="-1">3. 双主机、双从机重启 mysql 服务 <a class="header-anchor" href="#_3-双主机、双从机重启-mysql-服务" aria-label="Permalink to “3. 双主机、双从机重启 mysql 服务”">​</a></h4><h4 id="_4-在两台主机上建立帐户并授权-slave" tabindex="-1">4. 在两台主机上建立帐户并授权 slave <a class="header-anchor" href="#_4-在两台主机上建立帐户并授权-slave" aria-label="Permalink to “4. 在两台主机上建立帐户并授权 slave”">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span>create user &#39;slave&#39;@&#39;%&#39; identified with mysql_native_password by &#39;123456&#39;;</span></span>
<span class="line"><span>GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO &#39;slave&#39;@&#39;%&#39;;</span></span></code></pre></div><p>执行<code>show master status;</code>查询Master1和Master2的状态并记录</p><h4 id="_5-在从机上配置需要复制的主机" tabindex="-1">5. 在从机上配置需要复制的主机 <a class="header-anchor" href="#_5-在从机上配置需要复制的主机" aria-label="Permalink to “5. 在从机上配置需要复制的主机”">​</a></h4><p>Slava1 复制 Master1，Slava2 复制 Master2</p><p>方法同上</p><h4 id="_6-两个主机互相复制" tabindex="-1">6. 两个主机互相复制 <a class="header-anchor" href="#_6-两个主机互相复制" aria-label="Permalink to “6. 两个主机互相复制”">​</a></h4><p>Master2 复制 Master1，Master1 复制 Master2</p><p>方法同上</p><h4 id="_7-测试" tabindex="-1">7.测试 <a class="header-anchor" href="#_7-测试" aria-label="Permalink to “7.测试”">​</a></h4><p>Master1 主机新建库、新建表、insert 记录，Master2 和从机复制</p>`,109),e=[t];function d(r,g,y,F,c,A){return a(),i("div",null,e)}const C=s(k,[["render",d]]);export{D as __pageData,C as default};
