import{_ as g}from"./chunks/ArticleMetadata.BPSr9oED.js";import{_ as y,E as A,c as o,o as n,j as d,I as p,aj as r,w as h,b as e,e as k,a as c}from"./chunks/framework._AF764y6.js";const D="/assets/1656928075850-667a7757-c867-42a6-88d3-bdecc3f1c3ce_yh8k2o4dfr.BhzkNU21.png",F="/assets/1656952651446-16be7956-c96c-47f6-be2b-89dd5db67bcf_aUZkdikxas.BTlFobc1.png",C="/assets/1656952772559-17478284-9ed9-40b2-a592-548967509000_qEpbMc4ykS.DOH4gJy9.png",B="/assets/1656954000880-ff4b143b-b998-4baf-b1cd-976339d11fea_lyqHA9XUUc.NHdDqwJp.png",E="/assets/1657271987197-4c98f1f2-3fea-4620-9bcf-4d4d2bc45a1c_alaUhIYkAx.Bb5h6zvz.png",u="/assets/1657286425673-d62c1e3d-73be-46ef-97b1-457af4225c44_uHz6IvCQ01.C_YDIWkJ.png",m="/assets/1657287411894-ff6d91ca-e462-46d0-b272-2992e9b21b9d_mUmhexSnij.3yooJCnK.png",b="/assets/1657288232862-71bda1f9-d73f-4c03-b5a5-e92a57018b92_XNzAnJRJm4.Bn-VCwnl.png",v="/assets/1657330337381-1c7f477e-8ea3-4b27-b75d-59b5111c060a_PzbteCj3oP.BnVmJUuK.png",f="/assets/1657352078289-06822ec3-c02d-4ce5-8933-d0aae9beb195_ysIJWwuYCa.D7bOeyt8.png",x="/assets/1657352287927-5f7a13e5-31da-411c-b2c6-6284e3c51766_dLIYiL7zr4.CoNgrU31.png",j="/assets/1657353196588-b9de41f7-080e-4fd8-b789-be4e933c2663_lhwQjYoHrn.DIM1Rvvh.png",q="/assets/1657462531412-4e35b2cb-850f-42e1-a3a6-0dc0df038936_3zZPz3Ixg8.D2voYtb0.png",_="/assets/1657462854629-2459cab6-5b8e-4507-8dff-7afef57da440_JeeTjV7JLE.DBVHaDLx.png",P="/assets/1657463136580-fc3b5605-08f7-4116-95fb-970e9eb93215_MVCreCzoDV.8UV-6j9o.png",G="/assets/1657463772928-1f930fa3-7051-4c23-ad1a-8480196ff297_Kt39biPZq2.BkLfLj0s.png",T="/assets/1657463898076-e714abbe-06dc-4a28-8653-77b4cf811571_9xzmRtuqBb.CW6wC6hP.png",S="/assets/1657464614953-302f2666-c4b5-493e-bfc8-e1b4cc3ad95d_4rlNo4VE9I.D9vL8WcQ.png",w="/assets/1657464715942-dfbeaaba-e01b-4eec-a107-4ce8acba8a2d_AcqYE7MmGX.DYTkaWs6.png",L="/assets/1657465794388-229cc92b-a744-4eb5-a93a-acabddd8c460_kpPEYmZ7rZ.Di3SF9SL.png",M="/assets/1657468318061-5c3e1b8b-644d-48d3-ba68-4f9f7087dc5f_XmUH6fP5UF.MmJyjYAd.png",J="/assets/1657468328442-fee1e233-c517-4762-b8d6-e452f156583e_bjyuaNueyj.Dx1hslMr.png",O="/assets/1657468443035-ba9e155b-0a02-4256-8761-473da513260b_Mszo6v43iX.nwM0p7u2.png",R="/assets/1657469238964-8bc589b9-8e9c-4a12-b7fe-12916d2a42f8_pOKpwpcD9w.CzCJHj9i.png",N="/assets/1657469489339-f16b27f5-efc2-4797-ab0c-e5e44471144d_9HZyrVYPYe.D0MhWcIN.png",$="/assets/1657469572153-e49c1162-bcac-4651-9af1-96dd4c9a2bb1_qVgina81Xr.Cz9FEC4o.png",U="/assets/1657470316739-3b9b42d3-ccb9-412e-bdfa-5a10aa1b4d3e_4IfTsM1tGs.CQIkguFK.png",I="/assets/1657470383156-3f408913-ab81-4320-aee2-a1a2136067f0_T8Wm57jD2t.CEL-1xzb.png",ls=JSON.parse('{"title":"Gradle","description":"","frontmatter":{"title":"Gradle","date":"2023-10-26T21:10:55.000Z","permalink":"/gradle","categories":["运维"],"tags":["gradle"],"author":"Manaphy"},"headers":[],"relativePath":"ops/其他/08.Gradle.md","filePath":"ops/其他/08.Gradle.md","lastUpdated":1743259133000}'),H={name:"ops/其他/08.Gradle.md"},V=d("h1",{id:"_1-gradle入门",tabindex:"-1"},[c("1. Gradle入门 "),d("a",{class:"header-anchor",href:"#_1-gradle入门","aria-label":"Permalink to “1. Gradle入门”"},"​")],-1),z=r('<h2 id="_1-1-gradle简介" tabindex="-1">1.1 Gradle简介 <a class="header-anchor" href="#_1-1-gradle简介" aria-label="Permalink to “1.1 Gradle简介”">​</a></h2><p>Gradle 是一款 Google 推出的基于 JVM、通用灵活的项目构建工具，支持 Maven，JCenter 多种第三方仓库;支持传递性 依赖管理、废弃了繁杂的 xml 文件，转而使用简洁的、支持多种语言(例如：java、groovy 等)的 build 脚本文件。</p><p>官网地址: <a href="https://gradle.org/" target="_blank" rel="noreferrer">https://gradle.org/</a></p><p>学习 Gradle 的原因：</p><ol><li>目前已经有相当一部分公司在逐渐使用Gradle作为项目构建工具了。</li><li>作为Java开发程序员,如果想下载Spring、SpringBoot等Spring家族的源码，基本上基于Gradle构建的。</li></ol><h2 id="_1-2-常见的项目构建工具" tabindex="-1">1.2 常见的项目构建工具 <a class="header-anchor" href="#_1-2-常见的项目构建工具" aria-label="Permalink to “1.2 常见的项目构建工具”">​</a></h2><p>Ant: 2000 年 Apache 推出的纯 Java 编写构建工具，通过 xml[build.xml]文件管理项目</p><ul><li>优点：使用灵活，速度快(快于 gradle 和 maven)，</li><li>缺点： Ant 没有强加任何编码约定的项目目录结构,开发人员需编写繁杂 XML 文件构建指令,对开发人员是一个挑战。</li></ul><p>Maven: 2004 年 Apache 组织推出的再次使用 xml 文件[pom.xml]管理项目的构建工具。</p><ul><li>优点: 遵循一套约定大于配置的项目目录结构，使用统一的 GAV 坐标进行依赖管理,侧重于包管理。</li><li>缺点：项目构建过程僵化,配置文件编写不够灵活、不方便自定义组件,构建速度慢于 gradle。</li></ul><p>Gradle: 2012 年 Google 推出的基于 Groovy 语言的全新项目构建工具，集合了 Ant 和 Maven 各自的优势。</p><ul><li>优点：集 Ant 脚本的灵活性+Maven 约定大于配置的项目目录优势,支持多种远程仓库和插件,侧重于大项目构建。</li><li>缺点：学习成本高、资料少、脚本灵活、版本兼容性差等。</li></ul><p><img src="'+D+'" alt="image.png"></p><h2 id="_1-3-gradle安装" tabindex="-1">1.3 Gradle安装 <a class="header-anchor" href="#_1-3-gradle安装" aria-label="Permalink to “1.3 Gradle安装”">​</a></h2><p><a href="https://gradle.org/install/" target="_blank" rel="noreferrer">https://gradle.org/install/</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> GRADLE_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">/Users/manaphy/opt/gradle-7.4.2</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> GRADLE_USER_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">/Users/manaphy/.m2</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> M2_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">/Users/manaphy/opt/apache-maven-3.8.6</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> MVND_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">/Users/manaphy/opt/mvnd-0.8.0</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> JAVA_HOME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">/Users/manaphy/Library/Java/JavaVirtualMachines/azul-17.0.3/Contents/Home</span></span>\n<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> PATH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">${PATH}:${M2_HOME}/bin:${MVND_HOME}/bin:${JAVA_HOME}/bin:${GRADLE_HOME}/bin</span></span></code></pre></div><p>使用<code>gradle -v</code>查看是否安装成功</p><h2 id="_1-4-gradle-项目目录结构" tabindex="-1">1.4 Gradle 项目目录结构 <a class="header-anchor" href="#_1-4-gradle-项目目录结构" aria-label="Permalink to “1.4 Gradle 项目目录结构”">​</a></h2><p>Gradle 项目默认目录结构和 Maven 项目的目录结构一致,都是基于约定大于配置【Convention Over Configuration】。</p><p>其完整项目目录结构如下所示：</p><p><img src="'+F+'" alt="image.png"></p><blockquote><ol><li>只有war工程才有webapp目录，对于普通的jar工程并没有webapp目录</li><li>gradlew与gradlew.bat执行的指定wrapper版本中的gradle指令,不是本地安装的gradle指令哦。</li></ol></blockquote><h2 id="_1-5-gradle-创建第一个项目" tabindex="-1">1.5 Gradle 创建第一个项目 <a class="header-anchor" href="#_1-5-gradle-创建第一个项目" aria-label="Permalink to “1.5 Gradle 创建第一个项目”">​</a></h2><p>借助于 spring 脚手架创建 gradle 第一个项目：<a href="https://start.spring.io/" target="_blank" rel="noreferrer">https://start.spring.io/</a></p><p><img src="'+C+`" alt="image.png"></p><p>与上图对比会发现：总体的目录结构与上图说明的是一致的。</p><h3 id="_1-5-1-gradle-中的常用指令" tabindex="-1">1.5.1 Gradle 中的常用指令 <a class="header-anchor" href="#_1-5-1-gradle-中的常用指令" aria-label="Permalink to “1.5.1 Gradle 中的常用指令”">​</a></h3><table tabindex="0"><thead><tr><th style="text-align:left;">常用Gradle指令</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">gradle clean</td><td style="text-align:left;">清空build目录</td></tr><tr><td style="text-align:left;">gradle classes</td><td style="text-align:left;">编译业务代码和配置文件</td></tr><tr><td style="text-align:left;">gradle test</td><td style="text-align:left;">编译测试代码，生成测试报告</td></tr><tr><td style="text-align:left;">gradle build</td><td style="text-align:left;">构建项目</td></tr><tr><td style="text-align:left;">gradle build -x test</td><td style="text-align:left;">跳过测试构建项目</td></tr></tbody></table><p><strong>需要注意的是：gradle 的指令要在含有 build.gradle 的目录执行。</strong></p><h3 id="_1-5-2-修改-maven-下载源" tabindex="-1">1.5.2 修改 maven 下载源 <a class="header-anchor" href="#_1-5-2-修改-maven-下载源" aria-label="Permalink to “1.5.2 修改 maven 下载源”">​</a></h3><p>Gradle 自带的 Maven 源地址是国外的，该 Maven 源在国内的访问速度是很慢的，除非使用了特别的手段。一般情况下， 我们建议使用国内的第三方开放的 Maven 源或企业内部自建 Maven 源。</p><p><strong>认识 init.d 文件夹</strong></p><p>我们可以在 gradle 的 init.d 目录下创建以.gradle 结尾的文件， .gradle 文件可以实现在 build 开始之前执行，所以你可以在 这个文件配置一些你想预先加载的操作。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">allprojects {</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	repositories { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">		mavenLocal() </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">		maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Alibaba&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://maven.aliyun.com/repository/public&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">		maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Bstek&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://nexus.bsdn.org/content/groups/public/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">		mavenCentral() </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	buildscript { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">		repositories { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">			maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Alibaba&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;https://maven.aliyun.com/repository/public&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">			maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Bstek&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;https://nexus.bsdn.org/content/groups/public/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">			maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;M2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;https://plugins.gradle.org/m2/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">		} </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><strong>拓展1</strong>：启用 init.gradle 文件的方法有：</p><blockquote><ol><li>在命令行指定文件,例如：gradle --init-script yourdir/init.gradle -q taskName。你可以多次输入此命令来指定多个init文件</li><li>把init.gradle文件放到 USER_HOME/.gradle/ 目录下</li><li>把以.gradle结尾的文件放到 USER_HOME/.gradle/init.d/ 目录下</li><li>把以.gradle结尾的文件放到 GRADLE_HOME/init.d/ 目录下</li></ol></blockquote><p>如果存在上面的4种方式的2种以上，gradle会按上面的1-4序号依次执行这些文件，如果给定目录下存在多个init脚本，会 按拼音a-z顺序执行这些脚本，每个init脚本都存在一个对应的gradle实例,你在这个文件中调用的所有方法和属性，都会 委托给这个gradle实例，每个init脚本都实现了Script接口。</p><p><strong>拓展2</strong>：仓库地址说明</p><blockquote><p>mavenLocal(): 指定使用maven本地仓库，而本地仓库在配置maven时settings文件指定的仓库位置。如E:/repository，gradle 查找jar包顺序如下：<code>USER_HOME/.m2/settings.xml</code> &gt;&gt; <code>M2_HOME/conf/settings.xml</code> &gt;&gt; <code>USER_HOME/.m2/repository</code><code>maven { url 地址}</code>，指定maven仓库，一般用私有仓库地址或其它的第三方库【比如阿里镜像仓库地址】。 mavenCentral()：这是Maven的中央仓库，无需配置，直接声明就可以使用。 jcenter():JCenter中央仓库，实际也是是用的maven搭建的，但相比Maven仓库更友好，通过CDN分发，并且支持https访问,在新版本中已经废弃了，替换为了mavenCentral()。 总之, gradle可以通过指定仓库地址为本地maven仓库地址和远程仓库地址相结合的方式，避免每次都会去远程仓库下载 依赖库。这种方式也有一定的问题，如果本地maven仓库有这个依赖，就会从直接加载本地依赖，如果本地仓库没有该 依赖，那么还是会从远程下载。但是下载的jar不是存储在本地maven仓库中，而是放在自己的缓存目录中，默认在 <code>USER_HOME/.gradle/caches</code>目录,当然如果我们配置过GRADLE_USER_HOME环境变量，则会放在 GRADLE_USER_HOME/caches目录,那么可不可以将gradle caches指向maven repository。我们说这是不行的，caches下载 文件不是按照maven仓库中存放的方式。</p></blockquote><h3 id="_1-5-3-wrapper-包装器" tabindex="-1">1.5.3 Wrapper 包装器 <a class="header-anchor" href="#_1-5-3-wrapper-包装器" aria-label="Permalink to “1.5.3 Wrapper 包装器”">​</a></h3><p>Gradle Wrapper 实际上就是对 Gradle 的一层包装，用于解决实际开发中可能会遇到的不同的项目需要不同版本的 Gradle</p><p>问题。例如：把自己的代码共享给其他人使用，可能出现如下情况:</p><blockquote><ol><li>对方电脑没有安装 gradle</li><li>对方电脑安装过 gradle， 但是版本太旧了</li></ol></blockquote><p>这时候，我们就可以考虑使用 Gradle Wrapper 了。这也是官方建议使用 Gradle Wrapper 的原因。实际上有了 Gradle Wrapper 之后，我们本地是可以不配置 Gradle 的,下载 Gradle 项目后，使用 gradle 项目自带的 wrapper 操作也是可以的。</p><p>那如何使用 Gradle Wrapper 呢？</p><blockquote><p>项目中的gradlew、gradlew.cmd脚本用的就是wrapper中规定的gradle版本。 而我们上面提到的gradle指令用的是本地gradle,所以gradle指令和gradlew指令所使用的gradle版本<strong>有可能是不一样的</strong>。 gradlew、gradlew.cmd的使用方式与gradle使用方式完全一致，只不过把gradle指令换成了gradlew指令。</p></blockquote><p>当然,我们也可在终端执行 gradlew 指令时，指定指定一些参数,来控制 Wrapper 的生成，比如依赖的版本等，如下：</p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>参数名</strong></th><th style="text-align:left;"><strong>说明</strong></th></tr></thead><tbody><tr><td style="text-align:left;">--gradle--version</td><td style="text-align:left;">用于指定使用的Gradle版本</td></tr><tr><td style="text-align:left;">--gradle-distribution-url</td><td style="text-align:left;">用于指定下载Gradle发行版的url地址</td></tr></tbody></table><p>具体操作如下所示 ：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">gradle</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wrapper</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --gradle-version=4.4</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> # 升级wrapper版本号,只是修改gradle.properties中wrapper版本，未实际下载 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">gradle</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wrapper</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --gradle-version</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 5.2.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --distribution-type</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> all</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> # 关联源码用</span></span></code></pre></div><p><strong>GradleWrapper 的执行流程：</strong></p><blockquote><ol><li>当我们第一次执行 ./gradlew build 命令的时候， gradlew 会读取 gradle-wrapper.properties 文件的配置信息</li><li>准确的将指定版本的 gradle 下载并解压到指定的位置(GRADLE_USER_HOME目录下的wrapper/dists目录中)</li><li>并构建本地缓存(GRADLE_USER_HOME目录下的caches目录中),下载再使用相同版本的gradle就不用下载了</li><li>之后执行的 ./gradlew 所有命令都是使用指定的 gradle 版本。如下图所示：</li></ol></blockquote><p><img src="`+B+'" alt="image.png"></p><p><strong>gradle-wrapper.properties 文件解读</strong></p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>字段名</strong></th><th style="text-align:left;"><strong>说明</strong></th></tr></thead><tbody><tr><td style="text-align:left;">distributionBase</td><td style="text-align:left;">下载的Gradle压缩包解压后存储的主目录</td></tr><tr><td style="text-align:left;">distributionPath</td><td style="text-align:left;">相对于distributionBase的解压后的Gradle压缩包的路径</td></tr><tr><td style="text-align:left;">zipStoreBase</td><td style="text-align:left;">同distributionBase，只不过是存放zip压缩包的</td></tr><tr><td style="text-align:left;">zipStorePath</td><td style="text-align:left;">同distributionPath，只不过是存放zip压缩包的</td></tr><tr><td style="text-align:left;">distributionUrl</td><td style="text-align:left;">Gradle发行版压缩包的下载地址</td></tr></tbody></table><p>注意：前面提到的 <strong>GRALE_USER_HOME 环境变量</strong>用于这里的 Gradle Wrapper 下载的特定版本的 gradle 存储目录。如 果我们<strong>没有配置过 GRALE_USER_HOME 环境变量,默认在当前用户家目录下的.gradle 文件夹中。</strong></p><p>那什么时候选择使用 gradle wrapper、什么时候选择使用本地 gradle?</p><blockquote><p>下载别人的项目或者使用操作以前自己写的不同版本的gradle项目时：用Gradle wrapper,也即:gradlew 什么时候使用本地gradle?新建一个项目时: 使用gradle指令即可。</p></blockquote><h1 id="_2-groovy入门" tabindex="-1">2. Groovy入门 <a class="header-anchor" href="#_2-groovy入门" aria-label="Permalink to “2. Groovy入门”">​</a></h1>',59),W=r(`<h2 id="_2-1-groovy-简介" tabindex="-1">2.1 Groovy 简介 <a class="header-anchor" href="#_2-1-groovy-简介" aria-label="Permalink to “2.1 Groovy 简介”">​</a></h2><p>在某种程度上，Groovy 可以被视为 Java 的一种脚本化改良版,Groovy 也是运行在 JVM 上，它可以很好地与 Java 代码及 其相关库进行交互操作。它是一种成熟的面向对象编程语言，既可以面向对象编程，又可以用作纯粹的脚本语言。大多 数有效的 Java 代码也可以转换为有效的 Groovy 代码，Groovy 和 Java 语言的主要区别是：完成同样的任务所需的 Groovy 代码比 Java 代码更少。其特点为：</p><ul><li>功能强大，例如提供了动态类型转换、<strong>闭包</strong>和元编程（metaprogramming）支持</li><li>支持函数式编程，不需要 main 函数</li><li>默认导入常用的包</li><li>类不支持 default 作用域,且默认作用域为 public。</li><li>Groovy 中基本类型也是对象，可以直接调用对象的方法。</li><li>支持 DSL（Domain Specific Languages 领域特定语言）和其它简洁的语法，让代码变得易于阅读和维护。</li><li>Groovy 是基于 Java 语言的，所以完全兼容 Java 语法,所以对于 java 程序员学习成本较低。</li></ul><h2 id="_2-2-groovy基本语法" tabindex="-1">2.2 Groovy基本语法 <a class="header-anchor" href="#_2-2-groovy基本语法" aria-label="Permalink to “2.2 Groovy基本语法”">​</a></h2><h3 id="_2-2-1-基本注意点" tabindex="-1">2.2.1 基本注意点 <a class="header-anchor" href="#_2-2-1-基本注意点" aria-label="Permalink to “2.2.1 基本注意点”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">/* ---------------------------------------------------------------</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 1.groovy中使用def 定义属性、方法,def支持动态类型声明</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 2.单行注释：// 多行注释: /**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 3.gradle语句最后的;(分号)是可以省略的</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 4.groovy可以为属性自动生成getter、setter方法</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 5.方法声明时： 参数类型、返回值类型、return关键字可以省略,方法调用时,在不引起歧义的地方，可以省略()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 6.变量引用时： 在不引起歧义的前提下\\{}也可以省略,在容易引起歧义的地方就不能省略\\{}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 7.对象属性赋值：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式1: 对象.属性名=</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式2: 对象[&quot;属性名&quot;]=</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式3: 对象.属性setter方法()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式4: 具名构造器的方式</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 读取属性值：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式1: 对象.属性名</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式2: 对象[&quot;属性名&quot;]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> 方式3: 对象.属性getter方法()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> ---------------------------------------------------------------*/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">  description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;描述信息&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> bookname</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;斗破苍穹&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> sale</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">price</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">){</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    &quot;the book is  </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$price</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> sum</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">price1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">price2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">){</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    &quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$price1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> + </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$price2</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> = </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">price1+price2</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 调用</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> Temp</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">bookname</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;斗罗大陆&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;我是描述&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getBookname())</span></span></code></pre></div><h3 id="_2-2-3-引号说明" tabindex="-1">2.2.3 引号说明 <a class="header-anchor" href="#_2-2-3-引号说明" aria-label="Permalink to “2.2.3 引号说明”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;测试&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> str1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;单引号,不支持变量引用，不支持换行操作 \${desc}&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(str1)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> str2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;双引号,支持变量引用，不支持换行操作 </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">desc</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(str2)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> str3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;&#39;&#39;模板字符串,不支持变量引用，支持换</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">                  行操作 \${desc}&#39;&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(str3)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//基本数据类型也可以作为对象使用,可以调用对象的方法</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(str1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getClass()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">toString())</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// class java.lang.String</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(str2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getClass()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">toString())</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// class org.codehaus.groovy.runtime.GStringImpl</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(str3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getClass()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">toString())</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// class java.lang.String</span></span></code></pre></div><h3 id="_2-2-4-类型及权限修饰符" tabindex="-1">2.2.4 类型及权限修饰符 <a class="header-anchor" href="#_2-2-4-类型及权限修饰符" aria-label="Permalink to “2.2.4 类型及权限修饰符”">​</a></h3><p>权限修饰符: public、protected、private</p><p>Groovy 类与 Java 类之间的主要区别是</p><ol><li>没有可见性修饰符的类或方法自动是公共的(可以使用一个特殊的注释来实现包的私有可见性)。</li><li>没有可见性修饰符的字段将自动转换为属性，不需要显式的 getter 和 setter 方法。</li><li>如果属性声明为 final，则不会生成 setter。</li><li>一个源文件可能包含一个或多个类(但是如果一个文件不包含类定义的代码，则将其视为脚本)。脚本只是具有一些特殊 约定的类,它们的名称与源文件相同(所以不要在脚本中包含与脚本源文件名相同的类定义)。</li></ol><h3 id="_2-2-5-集合操作" tabindex="-1">2.2.5 集合操作 <a class="header-anchor" href="#_2-2-5-集合操作" aria-label="Permalink to “2.2.5 集合操作”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//--------------------list增删改查操作------------------------ </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//--------------------------------增------------------------</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//1.增:在集合中添加元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">instanceof</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> java.util.List</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">add(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">size()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//2.增:集合与集合相加</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> list2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">plus(list2) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//将list2添加在list之后</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//--------------------------------删------------------------</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//2.删:删除下标为2的元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">remove(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(list)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//2.删:删除集合中指定的元素</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">removeElement(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">12</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(list)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//2.删:从list集合中移除list3集合中的元素</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> list3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">removeAll(list3)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(list)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//2.删：从list表中弹出最后一个元素</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">pop()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(list)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//--------------------------------改------------------------</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">list</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">putAt(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//等效于 list[2] = 10</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(list)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//--------------------------------list增删改查操作-----------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">each({</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;Item: </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$it</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//it是对应于当前元素的隐式参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//size():获取此列表中的元素数。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//contains(): 如果此列表包含指定的值，则返回 true。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//---------------------------map的增删改查操作---------------------------</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 键 Key 可以不使用引号 , 可以使用单引号 &#39;&#39; , 也可以使用双引号 &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">J</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Java&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;K&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Kotlin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;G&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Groovy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//------------------------------------map的增--------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">put(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;P&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Python&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//map.putAll():增加一个map</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(map)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//------------------------------------map的删--------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">remove(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;P&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)   </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//根据某个键做移除</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">remove(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;J&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Java&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//移除某个键值对</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;删:&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//------------------------------------map的改--------------------------</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// &quot;-&quot; &quot;+&quot; 操作符重载</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">K</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Kotlin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> map2</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">G</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Gradle&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">] </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//键相同会产生覆盖</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> map3</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//------------------------------------map的查--------------------------</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">each { </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">value</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;key:</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$key</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">  value:</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$value</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">each { </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;key: </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">key</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> value: </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$entry</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">value</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_2-2-6-类导入" tabindex="-1">2.2.6 类导入 <a class="header-anchor" href="#_2-2-6-类导入" aria-label="Permalink to “2.2.6 类导入”">​</a></h3><p>Groovy 遵循 Java 允许 import 语句解析类引用的概念。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> groovy.xml.MarkupBuilder</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.text.SimpleDateFormat</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> xml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> MarkupBuilder</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> xml </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> null</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> sdf </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> SimpleDateFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;yyyy-MM-dd&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">);</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(sdf</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">format(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> Date</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()))</span></span></code></pre></div><p>Groovy 语言默认提供的导入</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.lang.* </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.util.* </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.io.* </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.net.* </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> groovy.lang.* </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> groovy.util.* </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.math.BigInteger </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> java.math.BigDecimal</span></span></code></pre></div><h3 id="_2-2-7-闭包" tabindex="-1">2.2.7 闭包 <a class="header-anchor" href="#_2-2-7-闭包" aria-label="Permalink to “2.2.7 闭包”">​</a></h3><p>闭包：Groovy 中的闭包是一个开放的、匿名的代码块，它可以接受参数、也可以有返回值。闭包可以引用其周围作用 域中声明的变量。</p><p>语法：<code>{ [closureParameters -&gt;] statements }</code></p><p>其中[ closureParameters-&gt;]是一个可选的逗号分隔的参数列表,参数后面是 Groovy 语句。参数类似于方法参数列表， 这些参数可以是类型化的,也可以是非类型化的。当指定参数列表时，需要使用-&gt; 字符，用于将参数与闭包体分离。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//闭包体完成变量自增操作</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ item</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//闭包使用 空参数列表 明确规定这是无参的</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> item</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//闭包中有一个默认的参数[it]，写不写无所谓</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> it } </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> it }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//如果不想使用默认的闭包参数it,那需要显示自定义参数的名称</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> name }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//闭包也可以接受多个参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">String</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;hey </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">x</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> the value is </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">y</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//闭包参数也可是一个对象</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{ </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">reader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> line </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> reader</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">readLine()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    line</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">trim()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>闭包调用方式： 闭包是<code>groovy.lang.Closure</code>的实例。它可以像任何其他变量一样分配给一个变量或字段。</p><p>闭包对象(参数)</p><p>闭包对象.call(参数)</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> isOdd </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">int</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> !=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> } </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> isOdd(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> isOdd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">call(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> false</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> isEven </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> { it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">%</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> ==</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> } </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> isEven(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> false</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">assert</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> isEven</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">call(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> true</span></span></code></pre></div><p>特殊说明： 可以把闭包当作一个对象，作为参数传递给方法使用</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//无参闭包 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Closure</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> closure</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">){</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;run start....&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    closure()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;run end....&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">} </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">run {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;running......&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">} </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//有参闭包 </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> caculate</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Closure</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> closure</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> num1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> num2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;caculate start....&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    closure(num1,num2) </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;caculate end....&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">caculate {</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">x</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot; 计算结果为：</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$x</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$y</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">x+y</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//在build.gradle文件中我们见到的很多都是闭包格式的。</span></span></code></pre></div><h1 id="gradle-进阶" tabindex="-1">Gradle 进阶 <a class="header-anchor" href="#gradle-进阶" aria-label="Permalink to “Gradle 进阶”">​</a></h1>`,31),Z=r('<h2 id="gradle-对测试支持" tabindex="-1">Gradle 对测试支持 <a class="header-anchor" href="#gradle-对测试支持" aria-label="Permalink to “Gradle 对测试支持”">​</a></h2><p>测试任务自动检测并执行测试源集中的所有单元测试。测试执行完成后会生成一个报告。支持 JUnit 和 TestNG 测试。</p><h3 id="默认测试目录及标准输出" tabindex="-1">默认测试目录及标准输出 <a class="header-anchor" href="#默认测试目录及标准输出" aria-label="Permalink to “默认测试目录及标准输出”">​</a></h3><p><img src="'+E+`" alt="image.png"></p><h3 id="junit-使用" tabindex="-1">Junit 使用 <a class="header-anchor" href="#junit-使用" aria-label="Permalink to “Junit 使用”">​</a></h3><p>Gradle 对于 Junit5.x 版本支持</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    testImplementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.junit.jupiter:junit-jupiter-api:5.8.1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    testRuntimeOnly </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.junit.jupiter:junit-jupiter-engine:5.8.1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">} </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">test {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    useJUnitPlatform() </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>注意：无论是 Junt4.x 版本还是 Junit5.x 版本，我们只需在 build.gradle 目录下执行 gradle test 指令，gradle 就会帮我们执 行所有的加了@Test 注解的测试，并生成测试报告。</p><h3 id="包含和排除特定测试" tabindex="-1">包含和排除特定测试 <a class="header-anchor" href="#包含和排除特定测试" aria-label="Permalink to “包含和排除特定测试”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">test {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    enabled(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 跳过测试</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    useJUnitPlatform()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    include(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com/cgp/test/**&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//只测试该目录下的类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    exclude(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com/cgp/run/**&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 排除测试</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h2 id="_3-1-项目的生命周期" tabindex="-1">3.1 项目的生命周期 <a class="header-anchor" href="#_3-1-项目的生命周期" aria-label="Permalink to “3.1 项目的生命周期”">​</a></h2><p>Gradle 项目的生命周期分为三大阶段: Initialization -&gt; Configuration -&gt; Execution. 每个阶段都有自己的职责,具体如下图所示:</p><p><img src="`+u+'" alt="image.png"></p><p>Initialization 阶段主要目的是初始化构建, 它又分为两个子过程,一个是执行 Init Script,另一个是执行 Setting Script。 init.gradle 文件会在每个项目 build 之前被调用，用于做一些初始化的操作，它主要有如下作用：</p><ul><li>配置内部的仓库信息（如公司的 maven 仓库信息）；</li><li>配置一些全局属性；</li><li>配置用户名及密码信息（如公司仓库的用户名和密码信息）。</li></ul><p>Setting Script 则更重要, 它初始化了一次构建所参与的所有模块。</p><p>Configuration 阶段：这个阶段开始加载项目中所有模块的 Build Script。所谓 &quot;加载&quot; 就是执行 build.gradle 中的语句, 根据脚本代码创建对应的 task, 最终根据所有 task 生成由 <strong>Task 组成的有向无环图</strong>(Directed Acyclic Graphs)，如下:</p><p><img src="'+m+'" alt="image.png"></p><p>Execution 阶段：这个阶段会根据上个阶段构建好的有向无环图，按着顺序执行 Task【Action 动作】。</p><h2 id="_3-2-settings-文件" tabindex="-1">3.2 settings 文件 <a class="header-anchor" href="#_3-2-settings-文件" aria-label="Permalink to “3.2 settings 文件”">​</a></h2><p>首先对 settings 文件的几点说明：</p><ol><li>作用：主要是在项目初始化阶段确定一下引入哪些工程需要加入到项目构建中,为构建项目工程树做准备。</li><li>工程树：gradle 中有工程树的概念，类似于 maven 中的 project 与 module。</li></ol><p><img src="'+b+`" alt="image.png"></p><ol start="3"><li>内容：里面主要定义了当前 gradle 项目及子 project 的项目名称</li><li>位置：必须放在根工程目录下。</li><li>名字：为 settings.gradle 文件，不能发生变化</li><li>对应实例：与 org.gradle.api.initialization.Settings 实例是一一对应的关系。每个项目只有一个 settings 文件。</li><li>关注：作为开发者我们只需要关注该文件中的 include 方法即可。使用相对路径【 : 】引入子工程。</li><li>一个子工程只有在 setting 文件中配置了才会被 gradle 识别,这样在构建的时候才会被包含进去。案例如下所示：</li></ol><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//根工程项目名 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rootProject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//包含的子工程名称 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;subject01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;subject02&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;subject03&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//包含的子工程下的子工程名称 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;subject01:subproject011&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;subject01:subproject012&#39;</span></span></code></pre></div><p>项目名称中 &quot;:&quot; 代表项目的分隔符, 类似路径中的 &quot;/&quot;. 如果以 &quot;:&quot; 开头则表示相对于 root project 。然后 Gradle 会 为每个带有 build.gradle 脚本文件的工程构建一个与之对应的 Project 对象。</p><h2 id="_3-3-task" tabindex="-1">3.3 Task <a class="header-anchor" href="#_3-3-task" aria-label="Permalink to “3.3 Task”">​</a></h2><p>项目实质上是 Task 对象的集合。一个 Task 表示一个逻辑上较为独立的执行过程，比如编译 Java 源代码，拷贝文件， 打包 Jar 文件，甚至可以是执行一个系统命令。另外，一个 Task 可以读取和设置 Project 的 Property 以完成特定的操作。</p><h3 id="_3-3-1-任务入门" tabindex="-1">3.3.1 任务入门 <a class="header-anchor" href="#_3-3-1-任务入门" aria-label="Permalink to “3.3.1 任务入门”">​</a></h3><p>让我们来先看一个例子:</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task A {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;root taskA&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doFirst(){</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;root taskA doFirst&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast(){</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;root taskA doLast&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在文件所在的目录执行命令: gradle A。</p><p>提示 1：task 的配置段是在<strong>配置阶段</strong>完成</p><p>提示 2：task 的 doFirst、doLast 方法是<strong>执行阶段</strong>完成，并且 doFirst 在 doLast 执行之前执行。</p><p>提示 3：<strong>区分任务的配置段和任务的行为</strong>,任务的配置段在<strong>配置阶段执行</strong>，任务的行为在<strong>执行阶段执行</strong></p><h3 id="_3-3-2-任务的行为" tabindex="-1">3.3.2 任务的行为 <a class="header-anchor" href="#_3-3-2-任务的行为" aria-label="Permalink to “3.3.2 任务的行为”">​</a></h3><p>案例如下：doFirst、doLast 两个方法可以在任务内部定义，也可以在任务外部定义</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> HashMap&lt;String, Object&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//action属性可以设置为闭包，设置task自身的行为</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">put(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, { </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskD..&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> })</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(map, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    description </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;taskA description....&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    group </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;cgp&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //在task内部定义doFirst、doLast行为</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doFirst {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;doFirst...&#39;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;doLast...&#39;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//在task外部定义doFirst、doLast行为</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doFirst{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">description</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">a</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doLast{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">group</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><img src="`+v+`" alt="image.png"></p><p><strong>底层原理分析</strong>：无论是定义任务自身的 action,还是添加的 doLast、doFirst 方法，其实底层都被放入到一个 Action 的 List中了，最初这个 action List 是空的，当我们设置了 action【任务自身的行为】,它先将 action 添加到列表中，此时列表中 只有一个 action,后续执行 doFirst 的时候 doFirst 在 action 前面添加，执行 doLast 的时候 doLast 在 action 后面添加。doFirst 永远添加在 actions List 的第一位，保证添加的 Action 在现有的 action List 元素的最前面；doLast 永远都是在 action List 末尾添加，保证其添加的 Action 在现有的 action List 元素的最后面。一个往前面添加,一个往后面添加，最后这个 action List 就按顺序形成了 doFirst、doSelf、doLast 三部分的 Actions,就达到 doFirst、doSelf、doLast 三部分的 Actions 顺序执 行的目的。</p><h3 id="_3-3-3-任务的依赖方式" tabindex="-1">3.3.3 任务的依赖方式 <a class="header-anchor" href="#_3-3-3-任务的依赖方式" aria-label="Permalink to “3.3.3 任务的依赖方式”">​</a></h3><p>Task 之间的依赖关系可以在以下几部分设置：</p><ol><li>参数依赖</li><li>内部依赖</li><li>外部依赖</li></ol><p><strong>方式一：参数方式依赖</strong></p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task A {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;TaskA..&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;TaskB..&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">} </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//参数方式依赖: dependsOn后面用冒号</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">dependsOn</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;TaskC..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><strong>方式二:内部依赖</strong></p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//参数方式依赖 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;C&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //内部依赖：dependsOn后面用 = 号 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependsOn </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [A, B]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;TaskC..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><strong>方式三：外部依赖</strong></p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//外部依赖:可变参数,引号可加可不加 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">C</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependsOn(B,</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span></code></pre></div><p><strong>当然：task 也支持跨项目依赖</strong></p><p>在 subproject01 工程的 build.gradle 文件中定义</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task A {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;TaskA..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在 subproject02 工程的 build.gradle 文件中定义</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task B {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependsOn(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;:subproject01:A&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//依赖根工程下的subject01中的任务A ：跨项目依赖。 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;TaskB..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>拓展 1：当一个 Task 依赖多个 Task 的时候，被依赖的 Task 之间如果没有依赖关系，那么它们的执行顺序是随机的，并无影响。</p><p><strong>拓展 2</strong>：重复依赖的任务只会执行一次，比如：</p><p>A-&gt;B、C</p><p>B-&gt;C</p><p>任务 A 依赖任务 B 和任务 C、任务 B 依赖 C 任务。执行任务 A 的时候，显然任务 C 被重复依赖了，C 只会执行一次。</p><h3 id="_3-3-4-任务执行-gradle相关命令" tabindex="-1">3.3.4 任务执行(Gradle相关命令) <a class="header-anchor" href="#_3-3-4-任务执行-gradle相关命令" aria-label="Permalink to “3.3.4 任务执行(Gradle相关命令)”">​</a></h3><p>任务执行语法：<code>gradle [taskName...] [--option-name...]</code></p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>分类</strong></th><th style="text-align:left;"><strong>命令</strong></th><th style="text-align:left;"><strong>解释</strong></th></tr></thead><tbody><tr><td style="text-align:left;">常见的任务</td><td style="text-align:left;">gradle build</td><td style="text-align:left;">构建项目：编译、测试、打包等操作</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle run</td><td style="text-align:left;">运行一个服务,需要 application 插件支持，并且指定了主启动类才能运行</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle clean</td><td style="text-align:left;">请求当前项目的 build 目录</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle init</td><td style="text-align:left;">初始化 gradle 项目使用</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle wrapper</td><td style="text-align:left;">生成 wrapper 文件夹</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle wrapper --gradle-version=4.4</td><td style="text-align:left;">升级 wrapper 版本号</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle wrapper --gradle-version 5.2.1 --distribution-type all</td><td style="text-align:left;">关联源码用</td></tr><tr><td style="text-align:left;">项目报告相关任务</td><td style="text-align:left;">gradle projects</td><td style="text-align:left;">列出所选项目及子项目列表，以层次结构的形式显示</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle tasks</td><td style="text-align:left;">列出所选项目【当前 project,不包含父、子】的已分配给任务组的那些任务</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle tasks --all</td><td style="text-align:left;">列出所选项目的所有任务</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle tasks --group=&quot;build setup&quot;</td><td style="text-align:left;">列出所选项目中指定分组中的任务</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle help --task someTask</td><td style="text-align:left;">显示某个任务的详细信息</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle dependencies</td><td style="text-align:left;">查看整个项目的依赖信息，以依赖树的方式显示</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle properties</td><td style="text-align:left;">列出所选项目的属性列表</td></tr><tr><td style="text-align:left;">调试相关选项</td><td style="text-align:left;">gradle -h (--help)</td><td style="text-align:left;">查看帮助信息</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -v (--version)</td><td style="text-align:left;">打印 Gradle、 Groovy、 Ant、 JVM 和操作系统版本信息</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -S (--full-stacktrace)</td><td style="text-align:left;">打印出所有异常的完整(非常详细)堆栈跟踪信息</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -s (--stacktrace)</td><td style="text-align:left;">打印出用户异常的堆栈跟踪(例如编译错误)</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -Dorg.gradle.daemon.debug=true</td><td style="text-align:left;">调试 Gradle 守护进程</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -Dorg.gradle.debug=true</td><td style="text-align:left;">调试 Gradle 客户端(非daemon)进程</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -Dorg.gradle.debug.port=(port)</td><td style="text-align:left;">指定启用调试时要侦听的端口号。默认值为 5005</td></tr><tr><td style="text-align:left;">性能选项:【备注:在 gradle.properties 中指定这些选项中的许多选项， 因此不需要命令行标志】</td><td style="text-align:left;">gradle --build-cache, --no-build-cache</td><td style="text-align:left;">尝试重用先前版本的输出。默认关闭(off)</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle --max-workers</td><td style="text-align:left;">设置 Gradle 可以使用的 woker 数。默认值是处理器数</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -parallel, --no-parallel</td><td style="text-align:left;">并行执行项目。有关此选项的限制，请参阅并行项目执行。 默认设置为关闭(off)</td></tr><tr><td style="text-align:left;">守护进程选项</td><td style="text-align:left;">gradle --daemon, --no-daemon</td><td style="text-align:left;">使用 Gradle 守护进程运行构建。默认是 on</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle --foreground</td><td style="text-align:left;">在前台进程中启动 Gradle 守护进程</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -Dorg.gradle.daemon.idletimeout=(number of milliseconds)</td><td style="text-align:left;">Gradle Daemon 将在这个空闲时间的毫秒数之后停止自己。默认值为 10800000(3 小时)。</td></tr><tr><td style="text-align:left;">日志选项</td><td style="text-align:left;">gradle -Dorg.gradle.logging.level=(quiet,warn,lifecycle,info,debug)</td><td style="text-align:left;">通过 Gradle 属性设置日志记录级别</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -q (--quiet)</td><td style="text-align:left;">只能记录错误信息</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -w (--warn)</td><td style="text-align:left;">设置日志级别为 warn</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -i (--info)</td><td style="text-align:left;">将日志级别设置为 info</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle -d (--debug)</td><td style="text-align:left;">登录调试模式(包括正常的堆栈跟踪)</td></tr><tr><td style="text-align:left;">其他</td><td style="text-align:left;">gradle -x ...(--exclude-task)</td><td style="text-align:left;">常见 gradle -x test clean build</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle --rerun-tasks</td><td style="text-align:left;">强制执行任务，忽略 up-to-date ,常见 gradle build --rerun-tasks</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle --continue</td><td style="text-align:left;">忽略前面失败的任务,继续执行,而不是在遇到第一个失败时立即停止执行。每 个遇到的故障都将在构建结束时报告，常见：gradle build --continue。</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle init --type pom</td><td style="text-align:left;">将 maven 项目转换为 gradle 项目(根目录执行)</td></tr><tr><td style="text-align:left;"></td><td style="text-align:left;">gradle [taskName]</td><td style="text-align:left;">执行自定义任务</td></tr></tbody></table><p>拓展：gradle 任务名是缩写: 任务名支持驼峰式命名风格的任务名缩写，如： connectTask 简写为： cT,执行任务 gradle cT。</p><p>拓展 1：前面提到的 Gradle 指令本质：一个个的 task[任务]，Gradle 中所有操作都是基于任务完成的。</p><p>拓展 2：gradle 默认各指令之间相互的依赖关系：</p><p><img src="`+f+`" alt="image.png"></p><h3 id="_3-3-5-任务定义方式" tabindex="-1">3.3.5 任务定义方式 <a class="header-anchor" href="#_3-3-5-任务定义方式" aria-label="Permalink to “3.3.5 任务定义方式”">​</a></h3><p>任务定义方式，总体分为两大类:一种是通过 Project 中的 task()方法,另一种是通过 tasks 对象的 create 或者 register 方法。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;A&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//任务名称,闭包都作为参数</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskA...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;B&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//闭包作为最后一个参数可以直接从括号中拿出来</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskB...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task C {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//groovy语法支持省略方法括号:上面三种本质是一种</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskC...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> map </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> HashMap&lt;String, Object&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">map</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">put(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;action&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, { </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskD..&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//action属性可以设置为闭包 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(map, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;D&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">create(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;E&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//使用tasks的create方法</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskE..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">register(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;f&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) { </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//注：register执行的是延迟创建。也即只有当task被需要使用的时候才会被创建。</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;taskF....&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>当然：我们也可以在定义任务的同时指定任务的属性，具体属性有：</p><p><img src="`+x+`" alt="image.png"></p><p><strong>在定义任务时也可以给任务分配属性</strong>：定义任务的时候可以直接指定任务属性，也可以给已有的任务动态分配属性：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//①.F是任务名，前面通过具名参数给map的属性赋值,以参数方式指定任务的属性信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">description</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;this is task B&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;F&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//②.H是任务名，定义任务的同时，在内部直接指定属性信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;H&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    group(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    description(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;this is the task H&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//③.Y是任务名，给已有的任务 在外部直接指定属性信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;y&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">group </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;chen&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">clean</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">group(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//案例：给已有的clean任务重新指定组信息</span></span></code></pre></div><p><img src="`+j+`" alt="image.png"></p><h3 id="_3-3-6-任务类型" tabindex="-1">3.3.6 任务类型 <a class="header-anchor" href="#_3-3-6-任务类型" aria-label="Permalink to “3.3.6 任务类型”">​</a></h3><p>前面我们定义的 task 都是 DefaultTask 类型的,如果要完成某些具体的操作完全需要我们自己去编写 gradle 脚本，势必有 些麻烦，那有没有一些现成的任务类型可以使用呢？有的， Gradle 官网给出了一些现成的任务类型帮助我们快速完成想 要的任务，我们只需要在创建任务的时候，指定当前任务的类型即可，然后即可使用这种类型中的属性和 API 方法了。</p><table tabindex="0"><thead><tr><th style="text-align:left;"><strong>常见任务类型</strong></th><th style="text-align:left;"><strong>该类型任务的作用</strong></th></tr></thead><tbody><tr><td style="text-align:left;">Delete</td><td style="text-align:left;">删除文件或目录</td></tr><tr><td style="text-align:left;">Copy</td><td style="text-align:left;">将文件复制到目标目录中。此任务还可以在复制时重命名和筛选文件。</td></tr><tr><td style="text-align:left;">CreateStartScripts</td><td style="text-align:left;">创建启动脚本</td></tr><tr><td style="text-align:left;">Exec</td><td style="text-align:left;">执行命令行进程</td></tr><tr><td style="text-align:left;">GenerateMavenPom</td><td style="text-align:left;">生成Maven模块描述符(POM)文件。</td></tr><tr><td style="text-align:left;">GradleBuild</td><td style="text-align:left;">执行Gradle构建</td></tr><tr><td style="text-align:left;">Jar</td><td style="text-align:left;">组装JAR归档文件</td></tr><tr><td style="text-align:left;">JavaCompile</td><td style="text-align:left;">编译Java源文件</td></tr><tr><td style="text-align:left;">Javadoc</td><td style="text-align:left;">为Java类生成HTMLAPI文档</td></tr><tr><td style="text-align:left;">PublishToMavenRepository</td><td style="text-align:left;">将MavenPublication发布到mavenartifactrepostal。</td></tr><tr><td style="text-align:left;">Tar</td><td style="text-align:left;">组装TAR存档文件</td></tr><tr><td style="text-align:left;">Test</td><td style="text-align:left;">执行JUnit(3.8.x、4.x或5.x)或TestNG测试。</td></tr><tr><td style="text-align:left;">Upload</td><td style="text-align:left;">将Configuration的构件上传到一组存储库。</td></tr><tr><td style="text-align:left;">War</td><td style="text-align:left;">组装WAR档案。</td></tr><tr><td style="text-align:left;">Zip</td><td style="text-align:left;">组装ZIP归档文件。默认是压缩ZIP的内容。</td></tr></tbody></table><h3 id="_3-3-7-任务的执行顺序" tabindex="-1">3.3.7 任务的执行顺序 <a class="header-anchor" href="#_3-3-7-任务的执行顺序" aria-label="Permalink to “3.3.7 任务的执行顺序”">​</a></h3><p>在 Gradle 中,有三种方式可以指定 Task 执行顺序：</p><ol><li>dependsOn 强依赖方式</li><li>通过 Task 输入输出</li><li>通过 API 指定执行顺序</li></ol><h3 id="_3-3-8-动态分配任务" tabindex="-1">3.3.8 动态分配任务 <a class="header-anchor" href="#_3-3-8-动态分配任务" aria-label="Permalink to “3.3.8 动态分配任务”">​</a></h3><p>gradle 的强大功能不仅仅用于定义任务的功能。例如，可以使用它在循环中注册同一类型的多个任务</p><h3 id="_3-3-9-任务的关闭与开启" tabindex="-1">3.3.9 任务的关闭与开启 <a class="header-anchor" href="#_3-3-9-任务的关闭与开启" aria-label="Permalink to “3.3.9 任务的关闭与开启”">​</a></h3><p>每个任务都有一个 enabled 默认为的标志 true。将其设置为 false 阻止执行任何任务动作。禁用的任务将标记为“跳过”。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task disableMe {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;This task is Executing...&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    enabled(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//直接设置任务开启，默认值为true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">disableMe</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">enabled </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //设置关闭任务</span></span></code></pre></div><h3 id="_3-3-10-任务的超时" tabindex="-1">3.3.10 任务的超时 <a class="header-anchor" href="#_3-3-10-任务的超时" aria-label="Permalink to “3.3.10 任务的超时”">​</a></h3><p>每个任务都有一个 timeout 可用于限制其执行时间的属性。当任务达到超时时，其任务执行线程将被中断。该任务将 被标记为失败。终结器任务仍将运行。如果 --continue 使用，其他任务可以在此之后继续运行。不响应中断的任务无法 超时。 Gradle 的所有内置任务均会及时响应超时</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task a() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        Thread.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">sleep(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;当前任务a执行了&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    timeout </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> Duration.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">ofMillis(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task b() {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;当前任务b执行了&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在控制台使用: <code>gradle a b</code> 测试会发现执行 a 的时候,由于 a 执行超时，抛出异常，所以没有继续往下执行【b 也没执行】。 然后在控制台使用: <code>gradle a b –continue</code>，测试会发现 a 虽然执行失败，但是 b 还是执行了。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task chen {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;chen.last...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//根据任务名查找</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">findByName(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doFirst({</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;1...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getByName(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doFirst({</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;2...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//根据任务路径查找【相对路径】</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">findByPath(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;:chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doFirst({</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;3...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getByPath(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;:chen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doFirst({</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;4...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span></code></pre></div><h3 id="_3-3-12-任务的规则" tabindex="-1">3.3.12 任务的规则 <a class="header-anchor" href="#_3-3-12-任务的规则" aria-label="Permalink to “3.3.12 任务的规则”">​</a></h3><p>当我们执行、依赖一个不存在的任务时，Gradle 会执行失败,报错误信息。那我们能否对其进行改进,当执行一个不存在 的任务时，不是报错而是打印提示信息呢？</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task hello {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;hello world&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">addRule(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot; 对该规则的一个描述，便于调试、查看等&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    String</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> taskName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        task(taskName) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot; 该</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">taskName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">任务不存在，请查证后再执行&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>测试: 使用 <code>gradle abc hello</code> 进行测试,此时当 abc 任务不存在时，也不会报异常【不中断执行】而是提示自定义的规则信 息，继续执行 hello 任务。此外，它还可以根据不同的规则动态创建需要的任务等情况。</p><h3 id="_3-3-13-任务的-onlyif-断言" tabindex="-1">3.3.13 任务的 onlyIf 断言 <a class="header-anchor" href="#_3-3-13-任务的-onlyif-断言" aria-label="Permalink to “3.3.13 任务的 onlyIf 断言”">​</a></h3><p>断言就是一个条件表达式。 Task 有一个 onlyIf 方法。它接受一个闭包作为参数，如果该闭包返回 true 则该任务执行， 否则跳过。这有很多用途，比如控制程序哪些情况下打什么包，什么时候执行单元测试，什么情况下执行单元测试的时 候不执行网络测试等。具体案例如下所示：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task hello {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;hello world&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">hello</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">onlyIf { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">hasProperty(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;fensi&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) }</span></span></code></pre></div><p>测试：通过-P 为 Project 添加 fensi 属性 <code>gradle hello -Pfensi</code></p><h3 id="_3-3-14-默认任务" tabindex="-1">3.3.14 默认任务 <a class="header-anchor" href="#_3-3-14-默认任务" aria-label="Permalink to “3.3.14 默认任务”">​</a></h3><p>Gradle 允许您定义一个或多个在没有指定其他任务时执行的默认任务。</p><p>代码如下所示：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">defaultTasks </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;myClean&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;myRun&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">register(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;myClean&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;Default Cleaning!&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">register(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;myRun&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;Default Running!&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">register(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;other&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;I&#39;m not a default task!&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>测试结果如下</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> gradle -q</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">Default</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Cleaning!</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">Default</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Running!</span></span></code></pre></div><h2 id="_3-4-gradle-中的文件操作" tabindex="-1">3.4 Gradle 中的文件操作 <a class="header-anchor" href="#_3-4-gradle-中的文件操作" aria-label="Permalink to “3.4 Gradle 中的文件操作”">​</a></h2><h3 id="_3-4-1-本地文件" tabindex="-1">3.4.1 本地文件 <a class="header-anchor" href="#_3-4-1-本地文件" aria-label="Permalink to “3.4.1 本地文件”">​</a></h3><p>使用 Project.file(java.lang.Object)方法，通过指定文件的相对路径或绝对路径来对文件的操作,其中相对路径为相对当前 project[根 project 或者子 project]的目录。其实使用 Project.file(java.lang.Object)方法创建的 File 对象就是 Java 中的 File 对象，我们可以使用它就像在 Java 中使用一样。示例代码如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//使用相对路径</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">File</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> configFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> file(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/1.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">configFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">createNewFile();</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 使用绝对路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">configFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> file(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;/Users/manaphy/Downloads/2.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(configFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">createNewFile()) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// true</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 使用一个文件对象</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">configFile </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/1.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(configFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">exists()) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// true</span></span></code></pre></div><h3 id="_3-4-2-文件集合" tabindex="-1">3.4.2 文件集合 <a class="header-anchor" href="#_3-4-2-文件集合" aria-label="Permalink to “3.4.2 文件集合”">​</a></h3><p>文 件 集 合 就 是 一 组 文 件 的 列 表 , 在 Gradle 中 , 文 件 集 合 用 FileCollection 接 口 表 示 。 我 们 可 以 使 用 Project.files(java.lang.Object[])方法来获得一个文件集合对象， 如下代码创建一个 FileCollection 实例：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> collection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> files(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/test1.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/test2.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">), [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/test3.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/test4.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">collection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">forEach() { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">File</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">createNewFile() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//创建该文件</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//输出文件名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Set</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> set1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> collection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">files </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 把文件集合转换为java中的Set类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Set</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> set2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> collection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> Set</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">List</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> list </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> collection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> List</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 把文件集合转换为java中的List类型</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (item </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> list) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> item</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> union </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> collection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> files(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/test5.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 添加或者删除一个集合</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> minus </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> collection </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> files(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/test3.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">union</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">forEach() { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">File</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> it</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>对于文件集合我们可以遍历它；也可以把它转换成 java 类型；同时还能使用+来添加一个集合，或使用-来删除集合。</p><h3 id="_3-4-3-文件树" tabindex="-1">3.4.3 文件树 <a class="header-anchor" href="#_3-4-3-文件树" aria-label="Permalink to “3.4.3 文件树”">​</a></h3><p>文件树是有层级结构的文件集合,一个文件树它可以代表一个目录结构或一 ZIP 压缩包中的内容结构。文件树是从文件集合继承过来的,所以文件树具有文件集合所有的功能。我们可以使用 Project.fileTree(java.util.Map)方法来创建文件树对象， 还可以使用过虑条件来包含或排除相关文件。示例代码如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">test {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//    enabled(false)// 跳过测试</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    useJUnitPlatform()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    include(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com/cgp/test/**&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//只测试该目录下的类</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    exclude(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com/cgp/run/**&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 排除测试</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 第一种方式:使用路径创建文件树对象，同时指定包含的文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tree </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> fileTree(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.java&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//第二种方式:通过闭包创建文件树:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tree </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> fileTree(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.java&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//第三种方式:通过路径和闭包创建文件树：具名参数给map传值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tree </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> fileTree(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">dir</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.java&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tree </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> fileTree(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">dir</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">includes</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.java&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.xml&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">exclude</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*test*/**&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 遍历文件树的所有文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tree</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">each { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">File</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> file </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_3-4-4-文件拷贝" tabindex="-1">3.4.4 文件拷贝 <a class="header-anchor" href="#_3-4-4-文件拷贝" aria-label="Permalink to “3.4.4 文件拷贝”">​</a></h3><p>我们可以使用 Copy 任务来拷贝文件，通过它可以过虑指定拷贝内容，还能对文件进行重命名操作等。 Copy 任务必须指 定一组需要拷贝的文件和拷贝到的目录，这里使用 <code>CopySpec.from(java.lang.Object[])</code>方法指定原文件；使用 <code>CopySpec.into(java.lang.Object)</code>方法指定目标目录。 示例代码如下</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task copyTask(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/resources&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    into </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;build/config&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>from()方法接受的参数和文件集合时 files()一样。 当参数为一个目录时，该目录下所有的文件都会被拷贝到指定目录下（目录自身不会被拷贝）；当参数为一个文件时，该文件会被拷贝到指定目录；如果参数指定的文件不存在，就会被忽略； 当参数为一个 Zip 压缩文件，该压缩文件的内容会被拷贝到指定目录。 into()方法接受的参数与本地文件时 file()一样。 示例代码如下</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task copyTask(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    // 拷贝src/main/webapp目录下所有的文件 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/webapp&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> // 拷贝单独的一个文件 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/staging/index.html&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> // 从Zip压缩文件中拷贝内容 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from zipTree(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/assets.zip&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 拷贝到的目标目录 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    into </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;build/explodedWar&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在拷贝文件的时候还可以添加过虑条件来指定包含或排除的文件，示例如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task copyTaskWithPatterns(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/webapp&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    into </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;build/explodedWar&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.html&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.jsp&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    exclude { </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">details</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> details</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">file</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">endsWith(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在拷贝文件的时候还可以对文件进行重命名操作，示例如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task rename(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Copy</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/webapp&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    into </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;build/explodedWar&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    // 使用一个闭包方式重命名文件 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    rename { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">String</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> fileName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        fileName</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">replace(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;-staging-&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在上面的例子中我们都是使用 Copy 任务来完成拷贝功能的，那么有没有另外一种方式呢？答案是肯定的，那就是 <code>Project.copy(org.gradle.api.Action)</code>方法。 下面示例展示了 copy()方法的使用方式：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task copyMethod {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        copy {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/webapp&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            into </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;build/explodedWar&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.html&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;**/*.jsp&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>或者使用 project 对象的 copy 方法</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">copy {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //相对路径或者绝对路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from file(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/resources/ddd.txt&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//file也可以换成new File()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    into </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildDir</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">absolutePath</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>执行 gradle build 指令即可。去 build 目录的本地磁盘查看，就能看到。</p><h3 id="_3-4-5-归档文件" tabindex="-1">3.4.5 归档文件 <a class="header-anchor" href="#_3-4-5-归档文件" aria-label="Permalink to “3.4.5 归档文件”">​</a></h3><p>通常一个项目会有很多的 Jar 包，我们希望把项目打包成一个 WAR，ZIP 或 TAR 包进行发布，这时我们就可以使用 Zip，Tar，Jar，War 和 Ear 任务来实现，不过它们的用法都一样，所以在这里我只介绍 Zip 任务的示例。 首先，创建一个 Zip 压缩文件,并指定压缩文件名称，如下代码所示：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">version </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1.0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task myZip(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Zip</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    from </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    into </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;build&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    archiveName(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;myGame.zip&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> myZip</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">archiveName</span></span></code></pre></div><p>执行命令 <code>gradle -q myZip</code></p><p>最后，我们可以使用 Project.zipTree(java.lang.Object)和 Project.tarTree(java.lang.Object)方法来创建访问 Zip 压缩包的文 件树对象，示例代码如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 使用zipTree </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FileTree</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> zip </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> zipTree(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;someFile.zip&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 使用tarTree </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">FileTree</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> tar </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> tarTree(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;someFile.tar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">)</span></span></code></pre></div><h2 id="_3-5-dependencies" tabindex="-1">3.5 Dependencies <a class="header-anchor" href="#_3-5-dependencies" aria-label="Permalink to “3.5 Dependencies”">​</a></h2><h3 id="_3-5-1-依赖的方式" tabindex="-1">3.5.1 依赖的方式 <a class="header-anchor" href="#_3-5-1-依赖的方式" aria-label="Permalink to “3.5.1 依赖的方式”">​</a></h3><p>Gradle 中的依赖分别为直接依赖，项目依赖，本地 jar 依赖。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //1.依赖当前项目下的某个模块[子工程]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;:subject01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //2.直接依赖本地的某个jar文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation files(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;libs/foo.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;libs/bar.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //2.配置某文件夹作为依赖项</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation fileTree(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">dir</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;libs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;*.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">])</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //3.直接依赖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.apache.logging.log4j:log4j:2.17.2&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><strong>直接依赖</strong>：在项目中直接导入的依赖，就是直接依赖</p><p><code>implementation &#39;org.apache.logging.log4j:log4j:2.17.2&#39;</code></p><p>上面是简写法，完整版写法如下：</p><p><code>implementation group: &#39;org.apache.logging.log4j&#39;, name: &#39;log4j&#39;, version: &#39;2.17.2&#39;</code></p><p>group/name/version 共同定位一个远程仓库,version 最好写一个固定的版本号，以防构建出问题，implementation 类似 maven 中的依赖的 scope,对比 maven 中的依赖:</p><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;log4j&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">groupId</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;log4j&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">artifactId</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;1.2.12&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;compile&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">scope</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">dependency</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span></code></pre></div><p><strong>项目依赖</strong>: 从项目的某个模块依赖另一个模块</p><p><code>implementation project(&#39;:subject01&#39;)</code></p><p>这种依赖方式是直接依赖本工程中的 libary module， 这个 libary module 需要在 setting.gradle 中配置。</p><p>本地 jar 依赖：本地 jar 文件依赖，一般包含以下两种方式</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//直接依赖某文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">implementation files(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;libs/foo.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;libs/bar.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//配置某文件夹作为依赖项</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">implementation fileTree(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">dir</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;libs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">include</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;*.jar&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">])</span></span></code></pre></div><h3 id="_3-5-2-依赖的下载" tabindex="-1">3.5.2 依赖的下载 <a class="header-anchor" href="#_3-5-2-依赖的下载" aria-label="Permalink to “3.5.2 依赖的下载”">​</a></h3><p>当执行 build 命令时，gradle 就会去配置的依赖仓库中下载对应的 Jar，并应用到项目中。</p><h3 id="_3-5-3-依赖的类型" tabindex="-1">3.5.3 依赖的类型 <a class="header-anchor" href="#_3-5-3-依赖的类型" aria-label="Permalink to “3.5.3 依赖的类型”">​</a></h3><p>类似于 Maven 的 scope 标签， gradle 也提供了依赖的类型,具体如下所示</p><table tabindex="0"><thead><tr><th style="text-align:left;">compileOnly</th><th style="text-align:left;">由java插件提供,曾短暂的叫provided,后续版本已经改成了compileOnly,适用于编译期需要而不需要打包的情况</th></tr></thead><tbody><tr><td style="text-align:left;">runtimeOnly</td><td style="text-align:left;">由java插件提供,只在运行期有效,编译时不需要,比如mysql驱动包。取代老版本中被移除的runtime</td></tr><tr><td style="text-align:left;">implementation</td><td style="text-align:left;">由java插件提供,针对源码[src/main目录],在编译、运行时都有效,取代老版本中被移除的compile</td></tr><tr><td style="text-align:left;">testCompileOnly</td><td style="text-align:left;">由java插件提供,用于编译测试的依赖项，运行时不需要</td></tr><tr><td style="text-align:left;">testRuntimeOnly</td><td style="text-align:left;">由java插件提供,只在测试运行时需要，而不是在测试编译时需要,取代老版本中被移除的testRuntime</td></tr><tr><td style="text-align:left;">testImplementation</td><td style="text-align:left;">由java插件提供,针对测试代码[src/test目录]取代老版本中被移除的testCompile</td></tr><tr><td style="text-align:left;">providedCompile</td><td style="text-align:left;">war插件提供支持，编译、测试阶段代码需要依赖此类jar包，而运行阶段容器已经提供了相应的支持，所以无需将这些文件打入到war包中了;例如servlet-api.jar、jsp-api.jar</td></tr><tr><td style="text-align:left;">compile</td><td style="text-align:left;">编译范围依赖在所有的classpath中可用，同时它们也会被打包。在gradle7.0已经移除</td></tr><tr><td style="text-align:left;">runtime</td><td style="text-align:left;">runtime依赖在运行和测试系统的时候需要,在编译的时候不需要,比如mysql驱动包。在gradle7.0已经移除</td></tr><tr><td style="text-align:left;">api</td><td style="text-align:left;">java-library插件提供支持,这些依赖项可以传递性地导出给使用者，用于编译时和运行时。取代老版本中被移除的compile</td></tr><tr><td style="text-align:left;">compileOnlyApi</td><td style="text-align:left;">java-library插件提供支持,在声明模块和使用者在编译时需要的依赖项，但在运行时不需要。</td></tr></tbody></table><h3 id="_3-5-4-api-与-implementation-区别" tabindex="-1">3.5.4 api 与 implementation 区别 <a class="header-anchor" href="#_3-5-4-api-与-implementation-区别" aria-label="Permalink to “3.5.4 api 与 implementation 区别”">​</a></h3><p><img src="`+q+'" alt="image.png"></p><p>总之，除非涉及到多模块依赖，为了避免重复依赖，咱们会使用 api,其它情况我们优先选择 implementation， 拥有大量 的 api 依赖项会显著增加构建时间。</p><h3 id="_3-5-5-依赖冲突及解决方案" tabindex="-1">3.5.5 依赖冲突及解决方案 <a class="header-anchor" href="#_3-5-5-依赖冲突及解决方案" aria-label="Permalink to “3.5.5 依赖冲突及解决方案”">​</a></h3><p>依赖冲突是指 &quot;在编译过程中, 如果存在某个依赖的多个版本, 构建系统应该选择哪个进行构建的问题&quot;,如下所示:</p><p><img src="'+_+`" alt="image.png"></p><p>A、B、C 都是本地子项目 module，log4j 是远程依赖。</p><p>编译时： B 用 1.4.2 版本的 log4j，C 用 2.2.4 版本的 log4j,B 和 C 之间没有冲突 打包时： 只能有一个版本的代码最终打包进最终的A对应的jar包，对于 Gradle 来说这里就有冲突了</p><p>案例演示：我们在 build.gradle 引入依赖库</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.hibernate:hibernate-core:3.6.3.Final&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j:slf4j-api:1.4.0&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><img src="`+P+`" alt="image.png"></p><p>如上所示：默认下，Gradle 会使用最新版本的 jar 包【考虑到新版本的 jar 包一般都是向下兼容的】，实际开发中，还 是建议使用官方自带的这种解决方案。<strong>当然除此之外，Gradle 也为我们提供了一系列的解决依赖冲突的方法</strong>: exclude 移除一个依赖，不允许依赖传递，强制使用某个版本。</p><ul><li>Exclude 排除某个依赖</li></ul><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.hibernate:hibernate-core:3.6.3.Final&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //排除某一个库(slf4j)依赖:如下三种写法都行</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        exclude </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        exclude </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;slf4j-api&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        exclude </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;slf4j-api&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //排除之后,使用手动的引入即可。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j:slf4j-api:1.4.0&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><ul><li>不允许依赖传递</li></ul><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.hibernate:hibernate-core:3.6.3.Final&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //不允许依赖传递，一般不用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        transitive(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //排除之后,使用手动的引入即可。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j:slf4j-api:1.4.0&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在添加依赖项时,如果设置 transitive 为 false,表示关闭依赖传递。即内部的所有依赖将不会添加到编译和运行时的类路径。</p><ul><li>强制使用某个版本</li></ul><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.hibernate:hibernate-core:3.6.3.Final&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //强制使用某个版本!!【官方建议使用这种方式】</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j:slf4j-api:1.4.0!!&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //这种效果和上面那种一样,强制指定某个版本</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.slf4j:slf4j-api:1.4.0&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        version {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            strictly(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;1.4.0&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>拓展：我们可以先查看当前项目中到底有哪些依赖冲突：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//下面我们配置，当 Gradle 构建遇到依赖冲突时，就立即构建失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">configurations</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">all() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    Configuration</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> configuration </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //当遇到版本冲突时直接构建失败</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        configuration</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">resolutionStrategy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">failOnVersionConflict()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h2 id="_3-6-gradle-插件" tabindex="-1">3.6 Gradle 插件 <a class="header-anchor" href="#_3-6-gradle-插件" aria-label="Permalink to “3.6 Gradle 插件”">​</a></h2><h3 id="_3-6-1-使用插件的原因" tabindex="-1">3.6.1 使用插件的原因 <a class="header-anchor" href="#_3-6-1-使用插件的原因" aria-label="Permalink to “3.6.1 使用插件的原因”">​</a></h3><p>简单的说,通过应用插件我们可以</p><ol><li>促进代码重用、减少功能类似代码编写、提升工作效率</li><li>促进项目更高程度的模块化、自动化、便捷化</li><li>可插拔式的的扩展项目的功能</li></ol><h3 id="_3-6-2-插件的作用" tabindex="-1">3.6.2 插件的作用 <a class="header-anchor" href="#_3-6-2-插件的作用" aria-label="Permalink to “3.6.2 插件的作用”">​</a></h3><p>在项目构建过程中做很多事情，把插件应用到项目中，通常可以完成:</p><ol><li>可以添加任务【task】到项目中， 从而帮助完成测试、编译、打包等。</li><li>可以添加依赖配置到项目中。</li><li>可以向项目中拓展新的扩展属性、方法等。</li><li>可以对项目进行一些约定， 如应用 Java 插件后，约定 src/main/java 目录是我们的源代码存在位置，编译时编译这个 目录下的 Java 源代码文件。</li></ol><h3 id="_3-6-3-插件的分类和使用" tabindex="-1">3.6.3 插件的分类和使用 <a class="header-anchor" href="#_3-6-3-插件的分类和使用" aria-label="Permalink to “3.6.3 插件的分类和使用”">​</a></h3><p><img src="`+G+`" alt="image.png"></p><h4 id="第一种-脚本插件" tabindex="-1">第一种：脚本插件 <a class="header-anchor" href="#第一种-脚本插件" aria-label="Permalink to “第一种：脚本插件”">​</a></h4><p>脚本插件的本质就是一个脚本文件，使用脚本插件时通过 apply from:将脚本加载进来就可以了，后面的脚本文件可以是 本地的也可以是网络上的脚本文件，下面定义一段脚本，我们在 build.gradle 文件中使用它，具体如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//version.gradle文件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">ext {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    company </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;Chen&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    cfgs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">            compileSdkVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">JavaVersion.</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">VERSION_1_8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    spring </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">            version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;5.0.0&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>下面将将在构建文件中使用这个脚本文件，具体如下:</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//build.gradle文件</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//map作为参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;version.gradle&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task taskVersion {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;公司名称为：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">company</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">,JDK版本是</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">cfgs.compileSdkVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">,版本号是</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">spring.version</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><strong>意义</strong>：脚本文件模块化的基础，可按功能把我们的脚本进行拆分一个个公用、职责分明的文件，然后在主脚本文件引用， 比如：将很多共有的库版本号一起管理、应用构建版本一起管理等。</p><h4 id="第二种-对象插件之内部插件-核心插件" tabindex="-1">第二种：对象插件之内部插件[核心插件] <a class="header-anchor" href="#第二种-对象插件之内部插件-核心插件" aria-label="Permalink to “第二种：对象插件之内部插件[核心插件]”">​</a></h4><p>二进制插件[对象插件]就是实现了 org.gradle.api.Plugin 接口的插件，每个 Java Gradle 插件都有一个 plugin id。</p><p><img src="`+T+`" alt="image.png"></p><p>可通过如下方式使用一个 Java 插件：</p><p><code>apply plugin : &#39;java&#39; //map具名参数方式</code></p><p>或者：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//也可以使用闭包作为project.apply方法的一个参数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    plugin </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>通过上述代码就将 Java 插件应用到我们的项目中了，对于 Gradle 自带的核心插件都有唯一的 plugin id，其中 java 是 Java 插件的 plugin id,这个 plugin id 必须是唯一的，可使用应用包名来保证 plugin id 的唯一性。这里的 java 对应的 具体类型是 org.gradle.api.plugins.JavaPlugin，所以可以使用如下方式使用 Java 插件：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//使用方式1：Map具名参数,全类名</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">org.gradle.api.plugins.JavaPlugin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//org.gradle.api.plugins默认导入：使用方式2 apply plugin:JavaPlugin</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //核心插件，无需事先引入，使用方式3:插件的id</span></span></code></pre></div><h4 id="第三种-对象插件之第三方插件" tabindex="-1">第三种：对象插件之第三方插件 <a class="header-anchor" href="#第三种-对象插件之第三方插件" aria-label="Permalink to “第三种：对象插件之第三方插件”">​</a></h4><p>如果是使用第三方发布的二进制插件，一般需要配置对应的仓库和类路径</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//使用传统的应用方式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildscript {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ext {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        springBootVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;2.3.3.RELEASE&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        mavenLocal()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;http://maven.aliyun.com/nexus/content/groups/public&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    // 此处先引入插件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        classpath(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;org.springframework.boot:spring-boot-gradle-plugin:</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">springBootVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//再应用插件 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //社区插件,需要事先引入， 不必写版本号</span></span></code></pre></div><p>但是如果是第三方插件已经被托管在 <a href="https://plugins.gradle.org/" target="_blank" rel="noreferrer">https://plugins.gradle.org/</a> 网站上，就可以不用在 buildscript 里配置 classpath依赖了，直接使用新出的 plugins DSL 的方式引用，案例如下：</p><p><strong>使用 plugins DSL 方式</strong></p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">plugins { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> version </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;2.4.1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>注意：</p><ol><li>如果使用老式插件方式 buildscript{}要放在 build.gradle 文件的最前面,而新式 plugins{}没有该限制。</li><li>托管在网站 gradle 插件官网的第三方插件有两种使用方式，一是传统的 buildscript 方式，一种是 plugins DSL 方式 。</li></ol><h4 id="第四种-对象插件之用户自定义插件" tabindex="-1">第四种：对象插件之用户自定义插件 <a class="header-anchor" href="#第四种-对象插件之用户自定义插件" aria-label="Permalink to “第四种：对象插件之用户自定义插件”">​</a></h4><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> GreetingPluginExtension</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    Property&lt;String&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> getMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    Property&lt;String&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> getGreeter</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> GreetingPlugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6CB6FF;"> Plugin&lt;Project&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> apply</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Project</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> project</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> extension </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">extensions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">create(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;greeting&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">GreetingPluginExtension</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">extension.message.get()</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> from </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">extension.greeter.get()</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">GreetingPlugin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// Configure the extension using a DSL block</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">greeting {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    message </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;Hi&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    greeter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;Gradle&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>我们直接执行 hello 任务<code>./gradle hello</code> 即可,这种方式实现的插件我们一般不使用，因为这种方式局限性太强，只能本 Project，而其他的 Project 不能使用。</p><h3 id="_3-6-4-buildsrc-项目" tabindex="-1">3.6.4 buildSrc 项目 <a class="header-anchor" href="#_3-6-4-buildsrc-项目" aria-label="Permalink to “3.6.4 buildSrc 项目”">​</a></h3><p>buildSrc 是 Gradle 默认的插件目录，编译 Gradle 的时候会自动识别这个目录，将其中的代码编译为插件。</p><ol><li>首先先建立一个名为 buildSrc 的 java Module,将 buildSrc 从 included modules 移除,重新构建,然后只保留 build.gradle 和 src/main 目录，其他全部删掉,注意名字一定是 buildSrc,不然会找不到插件。</li><li>然后修改 Gradle 中的内容</li></ol><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;groovy&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> // 必 须apply plugin: &#39;maven-publish&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation gradleApi() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//必须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation localGroovy() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//必须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    google()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    mavenCentral() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//必须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//把项目入口设置为src/main/groovy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">sourceSets {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    main {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        groovy {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            srcDir </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/groovy&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><ol start="3"><li>创建入口目录，在 src/main 下创建代码入口目录，如下：</li></ol><p><img src="`+S+`" alt="image.png"></p><ol start="4"><li>然后实现插件代码 Text.groovy，注意文件后缀为 groovy,文件要引入 package com.cgp</li></ol><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">package</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> com.cgp</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> org.gradle.api.Plugin</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> org.gradle.api.Project</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;"> Text</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> implements</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6CB6FF;"> Plugin&lt;Project&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    @Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> apply</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Project</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> project</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;atguigu&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                println</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;自定义atguigu插件&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><ol start="5"><li>接下来在 main 目录下创建 resources 目录,在 resources 目录下创建 META-INF 目录， 在 META-INF 目录下创建gradle-plugins 目录，在 gradle-plugins 目录下创建 properties 文件</li><li>properties 文件可以自己命名，但是要以.properties 结尾，比如 com.cgp.plugin.properties,其com.cgp.plugin 就是定义的包名路径</li></ol><p><img src="`+w+`" alt="image.png"></p><ol start="7"><li>最后需要在 properties 文件中指明我们实现插件的全类名 implementation-class=com.cgp.Text</li></ol><p>到目前为止我们的插件项目已经写完了，在 module 引入我们写的插件 apply plugin:&#39;com.cgp.plugin&#39;,然后执行插件的 Task<code>./gradle cgp</code></p><p>这种形式的写法，在我们整个工程的 module 都可以使用，但也只是限制在本工程，其他工程不能使用。</p><p>改进：</p><p>第二种写插件的方式他只能在本工程中使用，而其他的项目工程不能使用，有时候我们需要一个插件在多个工程中使用， 这时候我们就需要把插件上传 maven 中。</p><ol><li>首先将上述 buildSrc 目录复制一份，修改文件夹名，然后在 settings.gradle 文件中使用 include 引入</li><li>修改 build.gradle 文件，发布到 maven 仓库中</li></ol><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;groovy&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> // 必 须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;maven-publish&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation gradleApi() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//必须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation localGroovy() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//必须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    google()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    mavenCentral() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//必须</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">sourceSets { </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//把项目入口设置为src/main/groovy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    main {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        groovy {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            srcDir </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/main/groovy&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">publishing {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    publications {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        myLibrary(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">MavenPublication</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            groupId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;com.cgp.plugin&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //指定GAV坐标信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            artifactId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;library&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            version </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;1.1&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            from components</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">java</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//发布jar包</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //from components.web///引入war插件，发布war包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$rootDir</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/lib/release&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //发布项目到私服中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;myRepo&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //name属性可选,表示仓库名称，url必填</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //发布地址:可以是本地仓库或者maven私服</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> layout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildDirectory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dir(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;repo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;http://my.org/repo&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            // change URLs to point to your repos, e.g. http://my.org/repo</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //认证信息:用户名和密码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            credentials {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;joe&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;secret&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><ol start="3"><li>执行 publish 指令,发布到根 project 或者 maven 私服仓库。</li><li>使用插件,在项目级 build.gradle 文件中将插件添加到 classpath</li></ol><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildscript {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$rootDir</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/lib/release&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        classpath </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.cgp.plugin:library:1.1&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//是在 atguiguplugin  中定义的插件 ID </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com.cgp.plugin&#39;</span></span></code></pre></div><ol start="5"><li>执行 gradle build 指令就会在控制台看到自定义插件的输出，说明自定义插件就已经生效了。</li></ol><p>最后，至于如何写一个插件，能帮助项目更加自动化或者便捷化，是值得大家未来需要长期思考、关注、努力的点。</p><h3 id="_3-6-5-插件的关注点" tabindex="-1">3.6.5 插件的关注点 <a class="header-anchor" href="#_3-6-5-插件的关注点" aria-label="Permalink to “3.6.5 插件的关注点”">​</a></h3><p><strong>第一点: 插件的引用</strong></p><p><code>apply plugin: &#39;插件名&#39;</code></p><p><strong>第二点:主要的功能[任务]</strong></p><p>当我们在工程中引入插件后，插件会自动的为我们的工程添加一些额外的任务来完成相应的功能。以 Java 插件为例，当 我们加入 java 插件之后，就加入了如下功能：</p><p><img src="`+L+`" alt="image.png"></p><p>如果要使用某个插件就应该按照它约定的目录结构设置，这样能大大提高我们的效率，当然各目录结构也可以自己定义。</p><p><strong>第四点：依赖管理</strong></p><p>比如前面我们提到的 依赖的类型[依赖管理]部分，不同的插件提供了不同的依赖管理。</p><p><strong>第五点：常用的属性</strong></p><p>例如：Java 插件会为工程添加一些常用的属性,我们可以直接在编译脚本中直接使用。</p><table tabindex="0"><thead><tr><th style="text-align:left;">属性名称</th><th style="text-align:left;">类型</th><th style="text-align:left;">默认值</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;">reportsDirName</td><td style="text-align:left;">String</td><td style="text-align:left;">reports</td><td style="text-align:left;">生成报告的目录名称</td></tr><tr><td style="text-align:left;">reportsDir</td><td style="text-align:left;">File（只读）</td><td style="text-align:left;">buildDir/reportsDirName</td><td style="text-align:left;">生成报告的目录</td></tr><tr><td style="text-align:left;">testResultsDirName</td><td style="text-align:left;">String</td><td style="text-align:left;">test-results</td><td style="text-align:left;">生成测试result.xml 文件的目录名称</td></tr><tr><td style="text-align:left;">testResultsDir</td><td style="text-align:left;">File（只读）</td><td style="text-align:left;">reportsDir/testReportDirName</td><td style="text-align:left;">生成测试报告的目录</td></tr><tr><td style="text-align:left;">libsDirName</td><td style="text-align:left;">String</td><td style="text-align:left;">libs</td><td style="text-align:left;">生成 lib 库的目录名称</td></tr><tr><td style="text-align:left;">libsDir</td><td style="text-align:left;">File（只读）</td><td style="text-align:left;">buildDir/libsDirName</td><td style="text-align:left;">生成 lib 库的目录</td></tr><tr><td style="text-align:left;">distsDirName</td><td style="text-align:left;">String</td><td style="text-align:left;">distributions</td><td style="text-align:left;">生成发布文件的目录名称</td></tr><tr><td style="text-align:left;">distsDir</td><td style="text-align:left;">File（只读）</td><td style="text-align:left;">buildDir/distsDirName</td><td style="text-align:left;">生成发布文件的目录</td></tr><tr><td style="text-align:left;">docsDirName</td><td style="text-align:left;">String</td><td style="text-align:left;">docs</td><td style="text-align:left;">生成帮助文档的目录名称</td></tr><tr><td style="text-align:left;">docsDir</td><td style="text-align:left;">File（只读）</td><td style="text-align:left;">buildDir/docsDirName</td><td style="text-align:left;">生成帮助文档的目录</td></tr><tr><td style="text-align:left;">dependencyCacheDirName</td><td style="text-align:left;">String</td><td style="text-align:left;">dependency-cache</td><td style="text-align:left;">存储缓存资源依赖信息的目录名称</td></tr><tr><td style="text-align:left;">dependencyCacheDir</td><td style="text-align:left;">File（只读）</td><td style="text-align:left;">buildDir/dependencyCacheDirName</td><td style="text-align:left;">存储缓存资源依赖信息的目录</td></tr><tr><td style="text-align:left;">当然，这里还有一些其它属性</td><td style="text-align:left;"></td><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">sourceSets</td><td style="text-align:left;">SourceSetContainer (只读)</td><td style="text-align:left;">Not null</td><td style="text-align:left;">包含工程的资源集合（source sets.）</td></tr><tr><td style="text-align:left;">sourceCompatibility</td><td style="text-align:left;">JavaVersion</td><td style="text-align:left;">根据使用的 JVM 定</td><td style="text-align:left;">编译java文件时指定使用的java 版本</td></tr><tr><td style="text-align:left;">targetCompatibility</td><td style="text-align:left;">JavaVersion</td><td style="text-align:left;">sourceCompatibility</td><td style="text-align:left;">生成 classes 的 java 版本</td></tr><tr><td style="text-align:left;">archivesBaseName</td><td style="text-align:left;">String</td><td style="text-align:left;">projectName</td><td style="text-align:left;">作为归档文件的默认名称，如JAR 或者 ZIP 文件的名称</td></tr></tbody></table><h3 id="_3-6-6-java-插件分析" tabindex="-1">3.6.6 Java 插件分析 <a class="header-anchor" href="#_3-6-6-java-插件分析" aria-label="Permalink to “3.6.6 Java 插件分析”">​</a></h3><p><strong>第一点：我们要关注插件使用</strong></p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">plugins { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p><strong>第二点：我们要关注插件的功能</strong></p><p>我们可通过官方文档介绍了解某个插件功能或者百度、再或者大家可以通过 gradle tasks 查看加入 java 插件前后的区别。</p><p><strong>第三点：项目布局</strong></p><p>一般加入一个插件之后，插件也会提供相应的目录结构，例如：java 插件的目录结构</p><p>当然这个默认的目录结构也是可以改动的例如</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">sourceSets {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    main {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        java {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            srcDirs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/java&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        resources {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            srcDirs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;src/resources&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>也可设置源集的属性等信息。</p><p><strong>第四点：依赖管理：以 java 插件为例，提供了很多依赖管理项</strong></p><p><img src="`+M+'" alt="源集依赖关系配置"></p><p><img src="'+J+'" alt="测试源集依赖关系配置"></p><h2 id="_3-7-build-gradle-文件" tabindex="-1">3.7 build.gradle 文件 <a class="header-anchor" href="#_3-7-build-gradle-文件" aria-label="Permalink to “3.7 build.gradle 文件”">​</a></h2><ul><li>build.gradle 是一个 gradle 的构建脚本文件,支持 java、groovy 等语言。</li><li>每个 project 都会有一个 build.gradle 文件,该文件是项目构建的入口,可配置版本、插件、依赖库等信息。</li><li>每个 build 文件都有一个对应的 Project 实例,对 build.gradle 文件配置，本质就是设置 Project 实例的属性和方法。</li><li>由于每个 project 都会有一个 build 文件,那么 Root Project 也不列外.Root Project 可以获取到所有 Child Project,所以在Root Project 的 build 文件中我们可以对 Child Project 统一配置,比如应用的插件、依赖的 maven 中心仓库等。</li><li>build 文件中常见的属性和方法如下所示</li></ul><p><img src="'+O+`" alt="image.png"></p><h3 id="_3-7-1-常见属性代码" tabindex="-1">3.7.1 常见属性代码 <a class="header-anchor" href="#_3-7-1-常见属性代码" aria-label="Permalink to “3.7.1 常见属性代码”">​</a></h3><p>代码参考：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//指定使用什么版本的JDK语法编译源代码,跟编译环境有关,在有java插件时才能用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">sourceCompatibility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1.8</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//指定生成特定于某个JDK版本的class文件:跟运行环境有关,在有java插件时才能用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">targetCompatibility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1.8</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//业务编码字符集,注意这是指定源码解码的字符集[编译器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">compileJava</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//测试编码字符集,注意这是指定源码解码的字符集[编译器]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">compileTestJava</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//编译JAVA文件时采用UTF-8:注意这是指定源码编码的字符集【源文件】</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">withType(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">JavaCompile</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//编译JAVA文件时采用UTF-8:注意这是指定文档编码的字符集【源文件】</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">withType(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Javadoc</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>提示 1：group+name+version 类似于 maven 的 group+artifactId+version</p><p>提示 2：encoding 解决业务代码与测试代码中文乱码问题</p><h3 id="_3-7-2-repositories" tabindex="-1">3.7.2 Repositories <a class="header-anchor" href="#_3-7-2-repositories" aria-label="Permalink to “3.7.2 Repositories”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">repositories {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //gradle中会按着仓库配置的顺序，从上往下依次去对应的仓库中找所需要的jar包:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //如果找到，则停止向下搜索，如果找不到，继续在下面的仓库中查找</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //指定去本地某个磁盘目录中查找:使用本地file文件协议:一般不用这种方式</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;file:///D:/repos/mavenrepos3.5.4&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$rootDir</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">/lib/release&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //指定去maven的本地仓库查找</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    mavenLocal()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //指定去maven的私服或者第三方镜像仓库查找</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Alibaba&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://maven.aliyun.com/repository/public&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    maven { name </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;Bstek&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">; url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://nexus.bsdn.org/content/groups/public/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //指定去maven的远程仓库查找:即 https://repo.maven.apache.org/maven2/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    mavenCentral()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //去google仓库查找</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    google()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>因为 Gradle 没有自己的远程仓库，而是使用 Maven、jvy、google 这些远程仓库。</p><h3 id="_3-7-3-subprojects-与-allprojects" tabindex="-1">3.7.3 Subprojects 与 Allprojects <a class="header-anchor" href="#_3-7-3-subprojects-与-allprojects" aria-label="Permalink to “3.7.3 Subprojects 与 Allprojects”">​</a></h3><p>allprojects 是对所有 project(<strong>包括 Root Project+ child Project[当前工程和所有子工程]</strong>)的进行统一配置， 而 subprojects 是对<strong>所有 Child Project 的进行统一配置</strong>。</p><p>测试如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">allprojects {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">create(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;hello&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        doLast {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;project name is </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">subprojects {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    hello</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doLast { </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;here is subprojects </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>通常在 subprojects 和 allprojects 中</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">allprojects() { </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//本质Project中的allprojects方法，传递一个闭包作为参数。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ext {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        junitVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;4.10&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        ..</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    task allTask {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        ..</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        ..</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        ..</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">subprojects() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    ...</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//同上面allprojects中的方法。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>拓展 1: 如果是直接<strong>在根 project 配置</strong> repositories 和 dependencies 则<strong>只针对根工程有效</strong>。</p><p>拓展:我们也可以在对单个 Project 进行单独配置</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;subject01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    task subject01 {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">            println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;for subject01&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>执行 gradle build 指令即可查看测试效果。</p><h3 id="_3-7-4-ext-用户自定义属性" tabindex="-1">3.7.4 ext 用户自定义属性 <a class="header-anchor" href="#_3-7-4-ext-用户自定义属性" aria-label="Permalink to “3.7.4 ext 用户自定义属性”">​</a></h3><p>Project 和 Task 都允许用户添加额外的自定义属性，要添加额外的属性，通过应用所属对象的 ext 属性即可实现。添加 之后可以通过 ext 属性对自定义属性读取和设置，如果要同时添加多个自定义属性,可以通过 ext 代码块:</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//自定义一个Project的属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">ext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">age </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 18</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//通过代码块同时自定义多个属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">ext {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    phone </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 19292883833</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    address </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;北京天安门&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task extCustomProperty {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //在task中自定义属性</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ext {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        desc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;奥利给&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot; 年 龄 是 ：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">age</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;电话是：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">phone</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;地址是：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">address</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>拓展 1: ext 配置的是用户自定义属性，而 gradle.properties 中一般定义 系统属性、环境变量、项目属性、JVM 相关配置 信息。例如</p><p>gradle.properties 文件案例：加快构建速度的，gradle.properties 文件中的属性会自动在项目运行时加载。</p><div class="language-properties vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">## 设置此参数主要是编译下载包会占用大量的内存，可能会内存溢出</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">org.gradle.jvmargs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=-Xms4096m -Xmx8192m </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">## 开启gradle缓存</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">org.gradle.caching</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=true </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#开启并行编译</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">org.gradle.parallel</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=true </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#启用新的孵化模式</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">org.gradle.configureondemand</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=true </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#开启守护进程</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">org.gradle.daemon</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=true</span></span></code></pre></div><h3 id="_3-7-5-buildscript" tabindex="-1">3.7.5 Buildscript <a class="header-anchor" href="#_3-7-5-buildscript" aria-label="Permalink to “3.7.5 Buildscript”">​</a></h3><p>buildscript 里是 gradle 脚本执行所需依赖，分别是对应的 maven 库和插件。</p><p>案例如下：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> org.apache.commons.codec.binary.Base64</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildscript {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        mavenCentral()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        classpath </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;commons-codec&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;commons-codec&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">version</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;1.2&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">register(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;encode&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        def</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> byte</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[] encodedString </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> Base64</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encode(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;hello world</span><span style="--shiki-light:#005CC5;--shiki-dark:#F47067;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getBytes())</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> String</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(encodedString)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>需要注意的是：</p><ol><li>buildscript{}必须在 build.gradle 文件的最前端。</li><li>对于多项目构建，项目的 buildscript ()方法声明的依赖关系可用于其所有子项目的构建脚本。</li><li>构建脚本依赖可能是 Gradle 插件。</li></ol><p>案例如下所示：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//老式apply插件的引用方式,使用apply+buildscript</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildscript {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    ext {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        springBootVersion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;2.3.3.RELEASE&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        mavenLocal()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;http://maven.aliyun.com/nexus/content/groups/public&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //此处引入插件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        classpath(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;org.springframework.boot:spring-boot-gradle-plugin:</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">springBootVersion</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //核心插件，无需事先引入</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //社区插件，需要事先引入,才能应用，不必写版本号</span></span></code></pre></div><h2 id="_3-8-publishing-项目发布" tabindex="-1">3.8 publishing 项目发布 <a class="header-anchor" href="#_3-8-publishing-项目发布" aria-label="Permalink to “3.8 publishing 项目发布”">​</a></h2><p><strong>接下来，将咱们写好的模块发布发布到公司的私服以供别人使用,如下所示：</strong></p><p><img src="`+R+`" alt="image.png"></p><h3 id="_3-8-1-引入-maven-发布的插件" tabindex="-1">3.8.1 引入 maven 发布的插件 <a class="header-anchor" href="#_3-8-1-引入-maven-发布的插件" aria-label="Permalink to “3.8.1 引入 maven 发布的插件”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">plugins { </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java-library&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //如果发布war包，需要war插件,java-library支持带源码、文档发布 </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;maven-publish&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_3-8-2-设置发布代码" tabindex="-1">3.8.2 设置发布代码 <a class="header-anchor" href="#_3-8-2-设置发布代码" aria-label="Permalink to “3.8.2 设置发布代码”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//带源码和javadoc的发布:需要&#39;java-library&#39;插件支持:它是java的升级版，java插件的功能java-library都有</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//javadoc.options.encoding=&quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//java {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//	withJavadocJar()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//	withSourcesJar()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//} </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">publishing {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    publications {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        myLibrary(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">MavenPublication</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            groupId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;org.gradle.sample&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //指定GAV坐标信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            artifactId </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;library&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            version </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;1.1&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            from components</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">java</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//发布jar包</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //from components.web///引入war插件，发布war包</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //本地仓库位于USER_HOME/.m2/repository </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        mavenLocal()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //发布项目到私服中</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;myRepo&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //name属性可选,表示仓库名称，url必填</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //发布地址:可以是本地仓库或者maven私服</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //url = layout.buildDirectory.dir(&quot;repo&quot;)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            // change URLs to point to your repos, e.g. http://my.org/repo</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">            def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> releasesRepoUrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> layout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildDirectory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dir(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;repos/releases&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">            def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> snapshotsRepoUrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> layout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildDirectory</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dir(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;repos/snapshots&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            url </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> version</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">endsWith(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;SNAPSHOT&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">?</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> snapshotsRepoUrl </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> releasesRepoUrl</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">            //认证信息:用户名和密码</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            credentials {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                username </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;joe&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                password </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;secret&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_3-8-3-执行发布指令" tabindex="-1">3.8.3 执行发布指令 <a class="header-anchor" href="#_3-8-3-执行发布指令" aria-label="Permalink to “3.8.3 执行发布指令”">​</a></h3><p>执行发布命令，将项目发布到本地仓库或者远程仓库。常见的发布指令有</p><p>generatePomFileForPubNamePublication: 生成 pom 文件</p><p>publishPubNamePublicationToRepoNameRepository:发布项目到指定仓库,如果没有仓库名， 默认为 maven publishPubNamePublicationToMavenLocal: 将 PubName 发布复制到本地 Maven 仓库中包括 POM 文件和其他元数据。</p><p>publish: 发布到 repositories 中指定的仓库(为比如 Maven 私服)</p><p>publishToMavenLocal: 执行所有发布任务中的操作发布到本地 maven 仓库【默认在用户家目录下的.m2/repository】</p><h2 id="_3-9-生命周期中-hook" tabindex="-1">3.9 生命周期中 Hook <a class="header-anchor" href="#_3-9-生命周期中-hook" aria-label="Permalink to “3.9 生命周期中 Hook”">​</a></h2><p>生命周期中的这些钩子函数都是由 gradle 自动回调完成的,利用这些钩子函数可以帮助我们实现一些我们想要的功能。</p><p><img src="`+N+'" alt="image.png"></p><p>Gradle 在生命周期各个阶段都提供了用于回调的钩子函数:</p><p>Gradle 初始化阶段:</p><ul><li>在 settings.gradle 执行完后,会回调 Gradle 对象的 settingsEvaluated 方法</li><li>在构建所有工程 build.gradle 对应的Project 对象后,也既初始化阶段完毕,会回调 Gradle 对象的projectsLoaded 方法</li></ul><p>Gradle 配置阶段:</p><ul><li>Gradle 会循环执行每个工程的 build.gradle 脚本文件</li><li>在执行当前工程build.gradle 前,会回调Gradle 对象的 beforeProject 方法和当前Project 对象的 beforeEvaluate 方法, 虽然 beforeEvalute 属于 project 的生命周期, 但是此时 build script 尚未被加载, 所以 beforeEvaluate 的设置依 然要在 init script 或 setting script 中进行,不要在 build script 中使用 project.beforeEvaluate 方法。</li><li>在执行当前工程 build.gradle 后,会回调 Gradle 对象的afterProject 方法和当前Project 对象的 afterEvaluate 方法</li><li>在所有工程的 build.gradle 执行完毕后，会回调 Gradle 对象的 projectsEvaluated 方法</li><li>在构建 Task 依赖有向无环图后,也就是配置阶段完毕,会回调TaskExecutionGraph 对象的 whenReady 方法</li></ul><p>Gradle 执行阶段:</p><ul><li>Gradle 会循环执行Task 及其依赖的 Task</li><li>在当前 Task 执行之前,会回调 TaskExecutionGraph 对象的 beforeTask 方法</li><li>在当前 Task 执行之后,会回调 TaskExecutionGraph 对象的 afterTask 方法当所有的 Task 执行完毕后，会回调 Gradle 对象的 buildFinish 方法。</li></ul><p>提示：Gradle 执行脚本文件的时候会生成对应的实例，主要有如下几种对象：</p><ol><li>Gradle 对象：在项目初始化时构建，全局单例存在，只有这一个对象</li><li>Project 对象：**每一个build.gradle文件 **都会转换成一个 Project 对象,类似于maven中的pom.xml文件</li><li>Settings 对象：settings.gradle 会转变成一个 settings 对象,和整个项目是一对一的关系,一般只用到include方法</li><li>Task对象: 从前面的有向无环图中，我们也可以看出，gradle最终是基于Task的,一个项目可以有一个或者多个Task</li></ol><p>钩子函数代码演示：项目目录结构如下：</p><p><img src="'+$+`" alt="image.png"></p><p>在 root project 的 settings.gradle 文件中添加：</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">settingsEvaluated { </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//1.settingsEvaluated钩子函数,在初始化阶段完成</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;settingsEvaluated&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">projectsLoaded { </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//2.projectsLoaded钩子函数,在初始化阶段完成</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;projectsLoaded&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//声明一个变量：表示当前项目名,在每次执行某个项目的beforeEvaluate方法时先给projectName变量赋值</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//这样方便在：gradle.beforeProject和afterProject两个钩子函数使用。</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> projectName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">addProjectEvaluationListener(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> ProjectEvaluationListener</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">() {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //3.执行各个project的beforeEvaluate：在配置阶段完成</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    @Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> beforeEvaluate</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Project</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> project</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        projectName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">project.name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Project beforeEvaluate&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //5.执行各个project的afterEvaluate：在配置阶段完成\\</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    @Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> afterEvaluate</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Project</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> project</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">ProjectState</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> projectState</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">project.name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Project afterEvaluate&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">beforeProject {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//4.执行各个project的beforeProject：在配置阶段完成</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">projectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> beforeProject...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">afterProject {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//6.执行各个project的afterProject：在配置阶段完成</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">projectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> afterProject...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//7.所有工程的 build.gradle 执行完毕后，回调 Gradle 对象的 projectsEvaluated 方法：在配置阶段完成</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> rootProjectName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> rootProject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">getName()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">projectsEvaluated {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">rootProjectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> projectsEvaluated...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//8.配置阶段完毕后，回调 TaskExecutionGraph 对象的 whenReady 方法：在配置阶段完成</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">taskGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">whenReady {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">rootProjectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> taskGraph whenReady...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//9.在当前Task执行之前,会回调 TaskExecutionGraph 对象的 beforeTask方法：在执行阶段完成</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">taskGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">beforeTask { </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;this is the task </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">task.name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> of the project </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">task.getProject().name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> beforeTask..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//10.在当前Task执行之后,会回调 TaskExecutionGraph 对象的 afterTask方法：在执行阶段完成</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">taskGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">afterTask { </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;this is the task </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">task.name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> of the project </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">task.getProject().name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">  afterTask..&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//11.当所有的 Task 执行完毕后，会回调 Gradle 对象的 buildFinish 方法：在执行阶段完成</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildFinished {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">rootProjectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> buildFinished...&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在 root 的 build.gradle 文件中添加</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task A {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;root taskA&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> doFirst() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;root taskA doFirst&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;root taskA doLast&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在 subject01 的 build.gradle 文件中添加</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task B {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject01 taskB&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doFirst() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject01 taskB doFirst&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject01 taskB doLast&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>在 subject02 的 build.gradle 文件中添加</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//task C 在上面</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task C {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    // 依赖task D</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependsOn </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;D&#39;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject02 taskC&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doFirst() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject02 taskC doFirst&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject02 taskC doLast&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//task D 在下面</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">task D {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject02 taskD&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> doFirst() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject02 taskD doFirst&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    doLast() {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;SubProject02 taskD doLast&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>测试：在 root 工程的根目录执行：gradle C .就能看到 gradle 生命周期的三个阶段，及每个阶段执行的钩子函数、还有在 执行阶段有依赖关系的任务的执行顺序问题。</p><p>拓展 1：在 settings.gradle 中添加监听器，<strong>查看 task 有向无环图</strong>:</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">taskGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">addTaskExecutionGraphListener(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> TaskExecutionGraphListener</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">() {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    @Override</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    void</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> graphPopulated</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">TaskExecutionGraph</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> taskExecutionGraph</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 生成有向无环图</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        taskExecutionGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">allTasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">forEach(task </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//核心逻辑:通过taskExecutionGraph获得所有的task</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            taskExecutionGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">allTasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">forEach(releaseTask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">-&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">                println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;Chen:&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> releaseTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">getProject()</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;:&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> releaseTask</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">            })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span></code></pre></div><p>拓展 2: 计算 Gradle 构建过程中各个阶段的耗时:需要注意，这里只是计算了初始化阶段的 settings 文件，并没有计算 init.gradle 初始化的时间。</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> projectName </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> rootProject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">getName() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//定义项目名</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">long</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> beginOfSetting </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> System.</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">currentTimeMillis() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//初始化阶段开始时间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> beginOfConfig </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 配置阶段开始时间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> configHasBegin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> false</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //配置阶段是否开始了，只执行一次</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;"> beginOfProjectConfig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> new</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> HashMap</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">() </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//存放每个build.gradle 执行之前的时间</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> beginOfTaskExecute </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 执行阶段开始时间</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">projectsLoaded { </span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// 初始化阶段执行完毕</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">projectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">工程 初始化总耗时  </span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - beginOfSetting</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//build.gradle 执行前</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">beforeProject { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Project</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">configHasBegin) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        configHasBegin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        beginOfConfig </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> System.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">currentTimeMillis()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    beginOfProjectConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">put(project, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">System.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">currentTimeMillis())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//build.gradle 执行后</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">afterProject { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Project</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    def</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> begin </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> beginOfProjectConfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">get(project)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (project</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> projectName) {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;根工程</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">projectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 配置阶段耗时：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - begin</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;子工程</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">project.name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 配置阶段耗时：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - begin</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">taskGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">whenReady {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//配置阶段完毕</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;整个</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">projectName</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">项目在配置阶段总耗时：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - beginOfConfig</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    beginOfTaskExecute </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> System.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">currentTimeMillis()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//执行阶段开始</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">taskGraph</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">beforeTask { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">Task</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;"> task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> -&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doFirst {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">ext</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">beginOfTask </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> System.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">currentTimeMillis()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    task</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">doLast {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">        println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">task.name</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">在执行阶段耗时：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - task.ext.beginOfTask</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">gradle</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildFinished {</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//执行阶段完毕</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot; 执行阶段总耗时：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - beginOfTaskExecute</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">    println</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot; 整个构建过程耗时：</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">\${</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">System.currentTimeMillis() - beginOfSetting</span><span style="--shiki-light:#032F62;--shiki-dark:#F47067;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ms&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h2 id="_3-10-创建-springboot-项目" tabindex="-1">3.10 创建 Springboot 项目 <a class="header-anchor" href="#_3-10-创建-springboot-项目" aria-label="Permalink to “3.10 创建 Springboot 项目”">​</a></h2><p>Spring Boot Gradle 插件在 Gradle 提供 Spring Boot 支持。它允许您打包可执行 jar 或 war 归档文件，运行 SpringBoot 应用程序，并使用 Spring-Boot-dependencies 提供的依赖管理。</p><h3 id="_3-10-1-引入-springboot-插件" tabindex="-1">3.10.1 引入 springboot 插件 <a class="header-anchor" href="#_3-10-1-引入-springboot-插件" aria-label="Permalink to “3.10.1 引入 springboot 插件”">​</a></h3><p>该插件发布在 Gradle 的插件门户网站上，可以使用插件块来应用:</p><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">plugins {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> version </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;2.3.7.RELEASE&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> //维护springboot版本号,不单独使用,和下面两个插件一起用</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;io.spring.dependency-management&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> version </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;1.0.10.RELEASE&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //进行依赖管理,在引入其它boot依赖时省略版本号、解决jar包冲突问题</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    id </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_3-10-2-引入所需要的依赖" tabindex="-1">3.10.2 引入所需要的依赖 <a class="header-anchor" href="#_3-10-2-引入所需要的依赖" aria-label="Permalink to “3.10.2 引入所需要的依赖”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot:spring-boot-starter&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot:spring-boot-starter-web&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//省略版本,原生bom支持,插件management提供</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    testImplementation(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot:spring-boot-starter-test&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        exclude </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">group</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.junit.vintage&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">module</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;junit-vintage-engine&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">test {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    useJUnitPlatform()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_3-10-3-执行-gradle-bootrun-指令" tabindex="-1">3.10.3 执行 gradle bootRun 指令 <a class="header-anchor" href="#_3-10-3-执行-gradle-bootrun-指令" aria-label="Permalink to “3.10.3 执行 gradle bootRun 指令”">​</a></h3><p>要想运行当前 Springboot 项目，直接执行 gradle bootRun 指令或者 idea 右侧按钮即可。</p><p>当然如果想让当前项目打成可执行 jar 包，只需执行： gradle bootJar 指令即可。</p><p>Cloud 项目创建也可以借助于脚手架创建，与 Boot 项目类似。</p><h3 id="_3-10-4-拓展-spring-boot-gradle-plugin-插件" tabindex="-1">3.10.4 拓展 spring-boot-gradle-plugin 插件 <a class="header-anchor" href="#_3-10-4-拓展-spring-boot-gradle-plugin-插件" aria-label="Permalink to “3.10.4 拓展 spring-boot-gradle-plugin 插件”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">buildscript {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;https://maven.aliyun.com/repository/public&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        classpath </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot:spring-boot-gradle-plugin:2.4.1&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework.boot&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;io.spring.dependency-management&#39;</span></span></code></pre></div><h2 id="_3-11-基于-ssm-多模块项目案例" tabindex="-1">3.11 基于 ssm 多模块项目案例 <a class="header-anchor" href="#_3-11-基于-ssm-多模块项目案例" aria-label="Permalink to “3.11 基于 ssm 多模块项目案例”">​</a></h2><h3 id="_3-11-1-多项目模块划分" tabindex="-1">3.11.1 多项目模块划分 <a class="header-anchor" href="#_3-11-1-多项目模块划分" aria-label="Permalink to “3.11.1 多项目模块划分”">​</a></h3><p><img src="`+U+'" alt="image.png"></p><p>meinian-mobile-web: 美年旅游项目的用户系统</p><p>meinian-web:美年旅游项目的管理员系统</p><p>meinian-service:美年旅游项目的业务逻辑层</p><p>meinian-dao:美年旅游项目的持久化层</p><p>meinian-bean:美年旅游项目的Model 封装</p><h3 id="_3-11-2-项目搭建前配置分析" tabindex="-1">3.11.2 项目搭建前配置分析 <a class="header-anchor" href="#_3-11-2-项目搭建前配置分析" aria-label="Permalink to “3.11.2 项目搭建前配置分析”">​</a></h3><p><img src="'+I+`" alt="image.png"></p><h3 id="_3-11-3-代码演示" tabindex="-1">3.11.3 代码演示 <a class="header-anchor" href="#_3-11-3-代码演示" aria-label="Permalink to “3.11.3 代码演示”">​</a></h3><p>代码和配置文件同单体 ssm 一样。只不过做了拆分。</p><h3 id="_3-11-4-settings-gradle-文件中" tabindex="-1">3.11.4 settings.gradle 文件中 <a class="header-anchor" href="#_3-11-4-settings-gradle-文件中" aria-label="Permalink to “3.11.4 settings.gradle 文件中”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rootProject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">name </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;meinian-parent&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;meinian-bean&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;meinian-dao&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;meinian-service&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;meinian-web&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">include </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;meinian-mobile-web&#39;</span></span></code></pre></div><h3 id="_3-11-5-在根工程-build-gradle-文件中抽取子模块的公共配置" tabindex="-1">3.11.5 在根工程 build.gradle 文件中抽取子模块的公共配置 <a class="header-anchor" href="#_3-11-5-在根工程-build-gradle-文件中抽取子模块的公共配置" aria-label="Permalink to “3.11.5 在根工程 build.gradle 文件中抽取子模块的公共配置”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">group </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com.cgp&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">version </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;1.0-SNAPSHOT&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">subprojects {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //添加插件</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //基本JDK配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    sourceCompatibility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1.8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    targetCompatibility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1.8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    compileJava</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    compileTestJava</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;UTF-8&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    tasks</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">withType(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">JavaCompile</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        options</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">encoding </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &quot;UTF-8&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    group </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com.cgp&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    version </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;1.0-SNAPSHOT&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    repositories {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        mavenLocal()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://maven.aliyun.com/repository/public&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://maven.aliyun.com/repository/central&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://maven.aliyun.com/repository/google&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        maven { url </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;https://maven.aliyun.com/repository/spring&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        mavenCentral()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">    //依赖的配置:设置通用的依赖</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        testImplementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.junit.jupiter:junit-jupiter-api&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        testRuntimeOnly </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.junit.jupiter:junit-jupiter-engine&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;log4j:log4j:1.2.17&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    test {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        useJUnitPlatform()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><h3 id="_3-11-6-在根工程的-build-gradle-文件中配置各个模块的依赖信息" tabindex="-1">3.11.6 在根工程的 build.gradle 文件中配置各个模块的依赖信息 <a class="header-anchor" href="#_3-11-6-在根工程的-build-gradle-文件中配置各个模块的依赖信息" aria-label="Permalink to “3.11.6 在根工程的 build.gradle 文件中配置各个模块的依赖信息”">​</a></h3><div class="language-groovy vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">groovy</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;meinian-bean&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        compileOnly </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.projectlombok:lombok:1.18.24&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;meinian-dao&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java-library&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//支持api</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        api project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;:meinian-bean&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.mybatis:mybatis-spring:1.2.3&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;com.alibaba:druid:1.0.15&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.mybatis:mybatis:3.3.0&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;mysql:mysql-connector-java:5.1.36&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;meinian-service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;java-library&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">//支持api </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        api project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;:meinian-dao&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework:spring-web:4.1.7.RELEASE&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework:spring-test:4.0.5.RELEASE&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework:spring-jdbc:4.1.7.RELEASE&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.aspectj:aspectjweaver:1.8.6&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;meinian-web&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;war&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;:meinian-service&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework:spring-webmvc:4.1.7.RELEASE&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.fasterxml.jackson.core:jackson-databind:2.2.3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.fasterxml.jackson.core:jackson-annotations:2.2.3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.fasterxml.jackson.core:jackson-core:2.2.3&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        compileOnly </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;javax.servlet:servlet-api:2.5&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;jstl:jstl:1.2&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;meinian-mobile-web&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    apply </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;war&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    dependencies {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">        //implementation project(&#39;:meinian-bean&#39;) </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation project(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;:meinian-service&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;org.springframework:spring-webmvc:4.1.7.RELEASE&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.fasterxml.jackson.core:jackson-databind:2.2.3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.fasterxml.jackson.core:jackson-annotations:2.2.3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&quot;com.fasterxml.jackson.core:jackson-core:2.2.3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        compileOnly </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;javax.servlet:servlet-api:2.5&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">        implementation </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;jstl:jstl:1.2&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">}</span></span></code></pre></div><p>抽取之后，各子模块的 build.gradle 文件就不用配置了。</p>`,364);function K(s,Y,X,Q,ss,is){const l=g,t=A("ClientOnly");return n(),o("div",null,[V,p(t,null,{default:h(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),e(l,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),z,p(t,null,{default:h(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),e(l,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),W,p(t,null,{default:h(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),e(l,{key:0,article:s.$frontmatter},null,8,["article"])):k("",!0)]}),_:1}),Z])}const ts=y(H,[["render",K]]);export{ls as __pageData,ts as default};
