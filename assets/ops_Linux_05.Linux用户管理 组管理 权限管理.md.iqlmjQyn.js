import{_ as d}from"./chunks/ArticleMetadata.H12JcJLK.js";import{_ as g,E as y,c,o as n,j as F,I as t,aj as r,w as p,b as k,e,a as o}from"./chunks/framework._AF764y6.js";const V=JSON.parse('{"title":"Linux用户管理 组管理 权限管理","description":"","frontmatter":{"title":"Linux用户管理 组管理 权限管理","date":"2023-10-26T22:01:34.000Z","permalink":"/linux/user/","categories":["运维","Linux"],"tags":["linux"],"author":"Manaphy"},"headers":[],"relativePath":"ops/Linux/05.Linux用户管理 组管理 权限管理.md","filePath":"ops/Linux/05.Linux用户管理 组管理 权限管理.md","lastUpdated":1743618064000}'),D={name:"ops/Linux/05.Linux用户管理 组管理 权限管理.md"},C=F("h1",{id:"用户管理",tabindex:"-1"},[o("用户管理 "),F("a",{class:"header-anchor",href:"#用户管理","aria-label":"Permalink to “用户管理”"},"​")],-1),A=r(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 添加用户(创建用户成功后，会自动的创建和用户同名的家目录)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 添加用户并指定目录(给新创建的用户指定家目录)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /home/abc</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> lisi</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-d	指定用户的家目录（默认为/home/username）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-e	账户的到期时间，格式为 YYYY-MM-DD.</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-u	指定该用户的默认 UID</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-g	指定一个初始的用户基本组（必须已存在）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-G	指定一个或多个扩展用户组</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-N	不创建与用户同名的基本用户组</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-s	指定该用户的默认 Shell 解释器</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改用户的UID</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -u</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 8888</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-c	填写用户账户的备注信息</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-d -m	参数-m 与参数-d 连用，可重新指定用户的家目录并自动把旧的数据转移过去</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-e	账户的到期时间，格式为 YYYY-MM-DD</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-g	变更所属用户组</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-G	变更扩展用户组</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-L	锁定用户禁止其登录系统</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-U	解锁用户，允许其登录系统</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-s	变更默认终端</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-u	修改用户的 UID</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改当前用户密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">passwd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改指定用户密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-l	锁定用户,禁止其登录</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-u	解除锁定,允许用户登录</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">--stdin	通过标准输入修改用户密码,如 echo &quot;NewPassWord&quot; | passwd --stdin Username</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-d	使该用户可用空密码登录系统</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-e	强制用户在下次登录时修改密码</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-S	显示用户的密码是否被锁定，以及密码所采用的加密算法名称</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 删除用户(保留家目录)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">userdel</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 删除用户(删除家目录)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">userdel</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 强制删除用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">userdel</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 切换用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">su</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 切换到root账户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">su</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># #查看指定用户信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 查看活动用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">w</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 查看用户登录日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">last</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 查看系统所有用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -f1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/passwd</span></span></code></pre></div><ul><li><strong>/etc/passwd</strong> 文件: 用户(user)的配置文件，记录用户的各种信息</li></ul><p>每行的含义 用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录 Shell</p><ul><li><strong>/etc/shadow</strong> 文件: 口令的配置文件</li></ul><p>每行的含义 登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志</p><ul><li><strong>/etc/group</strong> 文件: 组(group)的配置文件，记录 Linux 包含的组的信息</li></ul><p>每行含义 组名:口令:组标识号:组内用户列表</p><h1 id="组管理" tabindex="-1">组管理 <a class="header-anchor" href="#组管理" aria-label="Permalink to “组管理”">​</a></h1>`,8),u=r(`<blockquote><p>在 linux 中的每个用户必须属于一个组，不能独立于组外。在 linux 中每个文件有所有者、所在组、其它组的概念。 谁创建了该文件,谁就是该文件的所有者 除文件的所有者和所在组的用户外，系统的其它用户都是文件的其它组</p></blockquote><p><img src="https://cdn-us.imgs.moe/2024/03/09/1610705892748-09f1e989-e9ea-464d-bdf0-1b5132cdfbec-20240309154446079_pPpvzxFxbN.png" alt="image.png"></p><p>上图红框内即为文件的所有者，蓝框即为文件的所在组</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 增加组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groupadd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wudang</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 删除组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groupdel</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wudang</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 重命名用户组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groupmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wudang</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> shaolin</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 查看test用户所在的组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groups</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> test</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 创建用户时直接加上组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wudang</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> zwj</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># #修改用户的组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> shaolin</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> zwj</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改文件所有者</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> zwj</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改文件所在组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wudang</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> test</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改用户chen的登录Shell、主目录以及用户组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /bin/ksh</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /home/gp</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> –g</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 查看系统所有组	</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -f1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/group</span></span></code></pre></div><h1 id="权限管理" tabindex="-1">权限管理 <a class="header-anchor" href="#权限管理" aria-label="Permalink to “权限管理”">​</a></h1>`,5),m=r('<h2 id="权限的基本介绍" tabindex="-1">权限的基本介绍 <a class="header-anchor" href="#权限的基本介绍" aria-label="Permalink to “权限的基本介绍”">​</a></h2><p>drwxr-xr-x  4 root root 4096 Jul 14  2020 tomcat</p><p>0-9位说明</p><p>第 <strong>0</strong> 位确定文件类型(d, - , l , c , b)</p><ul><li><strong>d</strong>: 目录 相当于Windows的文件夹</li><li><strong>l</strong>: 链接 相当于Windows的快捷方式</li><li><strong>c</strong>: 字符设备文件，如:鼠标、键盘</li><li>b: 块设备 如:硬盘</li></ul><p>第 <strong>1-3</strong> 位确定<strong>所有者</strong>拥有该文件的权限 ---User</p><p>第 <strong>4-6</strong> 位确定<strong>所属组</strong>拥有该文件的权限 ---Group</p><p>第 <strong>7-9</strong> 位确定<strong>其他用户</strong>拥有该文件的权限 ---Other</p><h2 id="rwx-权限详解" tabindex="-1">rwx 权限详解 <a class="header-anchor" href="#rwx-权限详解" aria-label="Permalink to “rwx 权限详解”">​</a></h2><p><strong>rwx 作用到文件</strong></p><ol><li>[ <strong>r</strong> ]代表可读(read): 可以读取，查看</li><li>[ <strong>w</strong> ]代表可写(write): 可以修改，但是不代表可以删除该文件，删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件</li><li>[ <strong>x</strong> ]代表可执行(execute): 可以被执行</li></ol><p><strong>rwx 作用到目录</strong></p><ol><li>[ <strong>r</strong> ]代表可读(read): 可以读取，ls 查看目录内容</li><li>[ <strong>w</strong> ]代表可写(write):  可以修改,  对目录内创建+删除+重命名目录</li><li>[ <strong>x</strong> ]代表可执行(execute): 可以进入该目录</li></ol><p><strong>文件及目录权限实际案例</strong></p><p>drwxr-xr-x  4 root root 4096 Jul 14  2020 tomcat</p><ul><li>drwxr-xr-x 10个字符确定不同用户能对文件干什么</li><li>4                      文件：硬连接数; 目录：子目录数</li><li>root                   用户</li><li>root                   组</li><li>4096                  文件大小(字节)，如果是文件夹，显示 4096 字节</li><li>Jul 14  2020     最后修改日期</li><li>tomcat             文件名</li></ul><h1 id="修改权限-所有者-所在组" tabindex="-1">修改权限 所有者 所在组 <a class="header-anchor" href="#修改权限-所有者-所在组" aria-label="Permalink to “修改权限 所有者 所在组”">​</a></h1>',17),b=r(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改权限</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 方式一:通过 + - = 变更权限 </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> u=rwx,g=rx,o=x</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> a.sh</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #给a.sh设置权限 u:所有者 g:所有组 o:其他人 rwx:对应读写可执行 a:所有人(u g o)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> o+w</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> a.sh</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #给a.sh文件加写入权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> o-w</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> a.sh</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #给a.sh文件去掉写入权限</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 方式二:通过数字变更权限 r=4 w=2 x=1	rwx=4+2+1=7</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 751</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> a.sh</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #该命令等同于 chmod u=rwx,g=rx,o=x a.sh</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 设置特殊权限,见文件的特殊权限内容</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">u+s	设置 SUID 权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">u-s	取消 SUID 权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">g+s	设置 SGID 权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">g-s	取消 SGID 权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">o+t	设置 SBIT 权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">o-t	取消 SBIT 权限</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">SUID=4,SGID=2,SBIT=1</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改文件所有者-chown</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chown</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> a.sh</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #改变所有者</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> tomcat</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #修改文件夹的所有者(递归生效)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 修改文件所在组-chgrp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chgrp</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> wudang</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> test</span></span></code></pre></div><h1 id="相关命令" tabindex="-1">相关命令 <a class="header-anchor" href="#相关命令" aria-label="Permalink to “相关命令”">​</a></h1>`,2),B=r(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#创建用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">userdel</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#删除用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> group_name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> user_name</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#修改用户的组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -aG</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> group_name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> user_name</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#将用户添加到组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">usermod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -s</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /bin/ksh</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /home/gp</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> –g</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> dev</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#修改用户chen的登录Shell、主目录以及用户组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groups</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> test</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看test用户所在的组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groupadd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> group_name</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#创建用户组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groupdel</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> group_name</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#删除用户组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">groupmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> new_name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> old_name</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#重命名用户组</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">su</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> -</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> user_name</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#完整切换到一个用户环境</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">passwd</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#修改口令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#修改某用户的口令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">w</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看活动用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">id</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看指定用户信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">last</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看用户登录日志</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">crontab</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -l</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看当前用户的计划任务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -f1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/passwd</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看系统所有用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">cut</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -d:</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -f1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/group</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">	#查看系统所有组</span></span></code></pre></div><h1 id="文件的特殊权限" tabindex="-1">文件的特殊权限 <a class="header-anchor" href="#文件的特殊权限" aria-label="Permalink to “文件的特殊权限”">​</a></h1>`,2),_=r(`<h2 id="suid" tabindex="-1">SUID <a class="header-anchor" href="#suid" aria-label="Permalink to “SUID”">​</a></h2><blockquote><p>SUID 是一种对二进制程序进行设置的特殊权限， 能够让二进制程序的执行者临时拥有 所有者 的权限（仅对拥有执行权限的二进制程序有效）。 例如， 所有用户都可以执行 passwd 命令来修改自己的用户密码， 而用户密码保存在 /etc/shadow 文件中。 仔细查看这个文件就会发现它的默认权限是 000，也就是说除了 root 管理员以外 ，所有用户都没有查看或编辑该文件的权限。 但是， 在使用 passwd 命令时如果加上 SUID 特殊权限位， 就可让普通用户临时获得程序所有者的身份， 把变更的密码信息写入到 shadow 文件中。 这很像在古装剧中见到的手持尚方宝剑的钦差大臣， 他手持的尚方宝剑代表的是皇上的权威， 因此可以惩戒贪官，但这并不意味着他永久成为了皇上。因此这只是一种有条件的、临时 的特殊权限授权方法。</p><p>查看 passwd 命令属性时发现所有者的权限由 rwx 变成了 rws，其中 x 改变成 s 就意味着该文件被赋予了 SUID 权限。另外有读者会好奇，那么如果原本的权限是 rw-呢？如果原先权限位上没有 x 执行权限，那么被赋予特殊权限后将变成大写的 S。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# ls -l /etc/shadow</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">----------</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 698</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Jan</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">  2021</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/shadow</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# ls -l /bin/passwd</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">-rwsr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 27856</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Apr</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">  1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">  2020</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /bin/passwd</span></span></code></pre></div><h2 id="sgid" tabindex="-1">SGID <a class="header-anchor" href="#sgid" aria-label="Permalink to “SGID”">​</a></h2><blockquote><p>SGID 特殊权限有两种应用场景：当对二进制程序进行设置时，能够让执行者临时获取文件所属组的权限；当对目录进行设置时，则是让目录内新创建的文件自动继承该目录原有用户组的名称。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# cd /tmp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# mkdir testdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# ls -ald testdir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">drwxr-xr-x</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 4096</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 22:11</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> testdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# chmod -R 777 testdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# chmod -R g+s testdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# ls -ald testdir</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">drwxrwsrwx</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 2</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 4096</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 22:11</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> testdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# su - chen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]$ cd /tmp/testdir</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy testdir]$ echo </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;hello world&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy testdir]$ ls -al test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">-rw-rw-r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 12</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 22:14</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> test</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #属于root组</span></span></code></pre></div><h2 id="sbit" tabindex="-1">SBIT <a class="header-anchor" href="#sbit" aria-label="Permalink to “SBIT”">​</a></h2><blockquote><p>SBIT 特殊权限位可确保用户只能删除自己的文件，而 不能删除其他用户的文件。换句话说，当对某个目录设置了 SBIT 粘滞位权限后，那么该目录 中的文件就只能被其所有者执行删除操作了。 RHEL 8 系统中的/tmp 作为一个共享文件的目录，默认已经设置了 SBIT 特殊权限位，因此除非是该目录的所有者，否则无法删除这里面的文件。 与前面所讲的 SUID 和 SGID 权限显示方法不同，当目录被设置 SBIT 特殊权限位后，文 件的其他用户权限部分的 x 执行权限就会被替换成 t 或者 T—原本有 x 执行权限则会写成 t， 原本没有 x 执行权限则会被写成 T。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# ls -ald /tmp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">drwxrwxrwt</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 8</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 4096</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 17:00</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /tmp</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy testdir]# cd /tmp</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# echo </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;hello world&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> test</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# chmod 777 test </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy tmp]# su chen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy tmp]$ rm -f test</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">rm:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> cannot</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ‘test’:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Operation</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> permitted</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #已经设置777权限但还是不能删除</span></span></code></pre></div><h1 id="文件的隐藏属性" tabindex="-1">文件的隐藏属性 <a class="header-anchor" href="#文件的隐藏属性" aria-label="Permalink to “文件的隐藏属性”">​</a></h1>`,10),f=r(`<blockquote><p>重要的系统文件，比如/etc/passwd，/etc/shadow，etc/fstab，/etc/sudoers 等，日常建议使用 chattr(change attribute)锁定，需要操作时再打开。使用lsattr(list attributes)查看文件是否有隐藏属性</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# chattr +i 1.txt </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# rm -f 1.txt </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">rm:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> cannot</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> ‘1.txt’:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Operation</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> permitted</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# chattr -i 1.txt </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# rm -f 1.txt</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">i	无法对文件进行修改；若对目录设置了该参数，则仅能修改其中的子文件内容而不能新建或删除文件</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">a	仅允许补充（追加）内容，无法覆盖/删除内容（Append Only）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">S	文件内容在变更后立即同步到硬盘（sync）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">s	彻底从硬盘中删除，不可恢复（用零块填充原文件所在的硬盘区域）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">A	不再修改这个文件或目录的最后访问时间（Atime）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">b	不再修改文件或目录的存取时间</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">D	检查压缩文件中的错误</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">d	使用 dump 命令备份时忽略本文件/目录</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">c	默认将文件或目录进行压缩</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">u	当删除该文件后依然保留其在硬盘中的数据，方便日后恢复</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">t	让文件系统支持尾部合并（tail-merging）</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">x	可以直接访问压缩文件中的内容</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# echo </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;hello world&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> &gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> 1.txt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# chattr +i 1.txt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# ll 1.txt </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 12</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 22:58</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 1.txt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# lsattr 1.txt </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">----i--------e--</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 1.txt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# chattr -i 1.txt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# lsattr 1.txt </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">-------------e--</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 1.txt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 案例</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #添加用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chattr</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> +i</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/passwd</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #锁定passwd相关的指令</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> manaphy</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #添加失败</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> cannot</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/passwd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 攻:别人可以通过解锁继续添加</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chattr</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/passwd</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 防:将指令移动到别的位置就不能解锁了</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">which</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chattr</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> #查看指令所在位置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">/usr/bin/chattr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /usr/bin/chattr</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /opt/</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 攻: 通过find指令找到后继续添加</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">find</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -name</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chattr</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 防: 将chattr改名</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /opt/chattr</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /opt/h</span></span></code></pre></div><h1 id="文件访问控制列表" tabindex="-1">文件访问控制列表 <a class="header-anchor" href="#文件访问控制列表" aria-label="Permalink to “文件访问控制列表”">​</a></h1>`,3),w=r(`<blockquote><p>前文讲解的一般权限、特殊权限、隐藏权限其实有一个共性——权限是针对某一类用户设置的，能够对很多人同时生效。如果希望对某个指定的用户进行单独 的权限控制，就需要用到文件的访问 控制列表（ACL）了。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy root]$ cd /root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">bash:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> cd:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /root:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Permission</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> denied</span></span></code></pre></div><h2 id="setfacl-命令" tabindex="-1">setfacl 命令 <a class="header-anchor" href="#setfacl-命令" aria-label="Permalink to “setfacl 命令”">​</a></h2><blockquote><p>setfacl 命令用于管理文件的 ACL 权限规则，英文全称为“set files ACL”，语法格式为 “setfacl [参数] 文件名称”。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# setfacl -Rm u:chen:rwx /root</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# su chen</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy root]$ cd /root</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-m	修改权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-M	从文件中读取权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-x	删除某个权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-b	删除全部权限</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">-R	递归子目录</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 查看是否有acl权限(末尾有+号表示该文件已经设置了 ACL)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy /]$ ll -d /root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">dr-xrwx---+</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 16</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 4096</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 22:58</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /root</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 针对某用户组设置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# setfacl -m g:chen:rw /etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 删除某用户组权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# setfacl -x g:chen /etc/fstab</span></span></code></pre></div><h2 id="getfacl-命令" tabindex="-1">getfacl 命令 <a class="header-anchor" href="#getfacl-命令" aria-label="Permalink to “getfacl 命令”">​</a></h2><blockquote><p>getfacl 命令用于查看文件的 ACL 权限规则，英文全称为“get files ACL”，语法格式为 “getfacl [参数] 文件名称”。</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy /]$ getfacl /root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">getfacl:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Removing</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> leading</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;/&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> absolute</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> path</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> names</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># file: root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># owner: root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># group: root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">user::r-x</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">user:chen:rwx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">group::r-x</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mask::rwx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">other::---</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# getfacl /etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">getfacl:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Removing</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> leading</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;/&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> absolute</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> path</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> names</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># file: etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># owner: root</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># group: root</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">user::rw-</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">group::r--</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">group:chen:rw-</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">mask::rw-</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">other::r--</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 备份与恢复权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">getfacl</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> home</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> backup.acl</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">setfacl</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --restore</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> backup.acl</span></span></code></pre></div><h1 id="su-命令与-sudo-服务" tabindex="-1">su 命令与 sudo 服务 <a class="header-anchor" href="#su-命令与-sudo-服务" aria-label="Permalink to “su 命令与 sudo 服务”">​</a></h1>`,9),x=r(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[root@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]# su - chen</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">Last</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> login:</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Mon</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 15</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> 23:26:28</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> CST</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 2022</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> pts/2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[chen@Manaphy </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]$ id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">uid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chen</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) gid</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chen</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">) groups</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chen</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span></code></pre></div><p>上面的 su 命令与用户名之间有一个减号（-），这意味着完全切 换到新的用户，即把环境变量信息也变更为新用户的相应信息，而不是保留原始的信息。强烈建议在切换用户身份时添加这个减号（-）。</p><h1 id="添加新用户案例" tabindex="-1">添加新用户案例 <a class="header-anchor" href="#添加新用户案例" aria-label="Permalink to “添加新用户案例”">​</a></h1>`,3),E=r(`<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#1.添加用户</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">useradd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#2.设置密码</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">passwd</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> chen</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#3.授予新用户root权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 777</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/sudoers</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/sudoers</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#在root这行添加一行新用户的权限</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#nopasswd:sudo不用输入密码</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#/usr/bin/cat,/usr/sbin/reboot:可以sudo cat /etc/shadow,可以sudo reboot</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">root</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    ALL=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ALL</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)       </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ALL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chen</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">    ALL=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">ALL</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)       </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">ALL</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> nopasswd:/usr/bin/cat,/usr/sbin/reboot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#4.改回权限</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">chmod</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 444</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/sudoers</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#5.禁止root登录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">vim</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> /etc/ssh/sshd_config</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#取消注释并修改为no</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">PermitRootLogin</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> no</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#6.重启sshd服务</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> sshd.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> sshd.service</span></span></code></pre></div>`,1);function v(s,T,S,M,I,P){const h=d,l=y("ClientOnly");return n(),c("div",null,[C,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),A,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),u,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),m,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),b,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),B,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),_,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),f,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),w,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),x,t(l,null,{default:p(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(n(),k(h,{key:0,article:s.$frontmatter},null,8,["article"])):e("",!0)]}),_:1}),E])}const R=g(D,[["render",v]]);export{V as __pageData,R as default};
